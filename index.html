<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="OriginSight åŸç”Ÿå®¶åº­æ·±åº¦å›æº¯æµ‹è¯„ï¼Œæ¢ç´¢ç«¥å¹´ç»å†å¯¹æ€§æ ¼çš„å½±å“ï¼Œç”Ÿæˆä¸“å±å¿ƒç†ç”»åƒã€‚">
<title>OriginSight â€” åŸç”Ÿå®¶åº­æ·±åº¦å›æº¯</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
    tailwind.config = {
        darkMode: 'media',
        theme: {
            extend: {
                colors: {
                    'heal-primary': '#5B7C99',
                    'heal-sec': '#A6B1A1',
                    'warm-bg': '#F9F8F6',
                }
            }
        }
    }
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js">

</script>

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
<style>
    body { font-family: 'Inter', -apple-system, sans-serif; transition: background-color 0.5s; background-color: #F9F8F6; color: #2c3e50; }
    h1, h2, h3, .serif { font-family: 'Noto Serif SC', serif; }
    
    .fade-in-up { animation: fadeInUp 0.8s cubic-bezier(0.16, 1, 0.3, 1) forwards; opacity: 0; transform: translateY(30px); }
    .delay-100 { animation-delay: 0.1s; } .delay-200 { animation-delay: 0.2s; } .delay-300 { animation-delay: 0.3s; }
    @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

    .page-enter { animation: pageEnter 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    .page-exit { animation: pageExit 0.4s ease-in forwards; }
    @keyframes pageEnter { from { opacity: 0; transform: scale(0.98) translateY(10px); filter: blur(4px); } to { opacity: 1; transform: scale(1) translateY(0); filter: blur(0); } }
    @keyframes pageExit { to { opacity: 0; transform: scale(1.02); filter: blur(4px); } }

    .glass { background: rgba(255, 255, 255, 0.7); backdrop-filter: saturate(180%) blur(20px); border-bottom: 1px solid rgba(0,0,0,0.05); }

    .spotlight-card { position: relative; overflow: hidden; transition: transform 0.3s ease; }
    .spotlight-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: radial-gradient(800px circle at var(--mouse-x) var(--mouse-y), rgba(91, 124, 153, 0.08), transparent 40%); z-index: 0; pointer-events: none; opacity: 0; transition: opacity 0.3s; }
    .spotlight-card:hover::before { opacity: 1; }
    .spotlight-card:hover { transform: translateY(-2px); }

    #progress-bar { transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1); }

    /* --- Ocean Wave Animation (Seamless) --- */
    :root {
        --ocean-top: #F9F8F6;
        --ocean-mid: #eef2f3;
        --ocean-bot: #dfe9f3;
        --wave-1: #5B7C99;
        --wave-2: #7F9EB2;
        --wave-3: #A4B8C4;
    }

    #ocean-container {
        background: linear-gradient(to bottom, var(--ocean-top), var(--ocean-mid), var(--ocean-bot));
        transition: background 2s ease; /* é¢œè‰²å¹³æ»‘è¿‡æ¸¡ */
    }

    .wave-layer {
        background-repeat: repeat-x;
        background-position: bottom left;
        background-size: 50% 100%; /* å…³é”®ï¼šç¡®ä¿ä¸¤æ®µèƒŒæ™¯å›¾åˆšå¥½å¡«æ»¡200%å®½åº¦çš„divï¼Œå®ç°æ— ç¼ */
        animation: waveMove linear infinite;
        transform-origin: center bottom;
        transition: filter 2s ease, opacity 2s ease;
    }
    /* é‡æ–°ç»˜åˆ¶çš„æ— ç¼ SVG æ³¢æµª */
    .layer-1 { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 180' preserveAspectRatio='none'%3E%3Cpath d='M0 45C165.5 45 285.5 132 400 132C514.5 132 660.5 45 800 45V180H0V45Z' fill='%235B7C99'/%3E%3C/svg%3E"); }
    .layer-2 { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 180' preserveAspectRatio='none'%3E%3Cpath d='M0 45C165.5 45 285.5 132 400 132C514.5 132 660.5 45 800 45V180H0V45Z' fill='%237F9EB2'/%3E%3C/svg%3E"); animation-delay: -5s; /* é”™å¼€æ³¢å³° */ }
    .layer-3 { background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 800 180' preserveAspectRatio='none'%3E%3Cpath d='M0 45C165.5 45 285.5 132 400 132C514.5 132 660.5 45 800 45V180H0V45Z' fill='%23A4B8C4'/%3E%3C/svg%3E"); animation-delay: -10s; }

    @keyframes waveMove {
        0% { transform: translateX(0); }
        100% { transform: translateX(-50%); } /* ç§»åŠ¨è‡ªèº«çš„ä¸€åŠï¼ˆå³100%å±å¹•å®½åº¦ï¼‰ï¼Œå®ç°æ— ç¼å¾ªç¯ */
    }

    /* æµ®æ²‰æ–‡å­—æ ·å¼ï¼ˆå¢å¼ºç‰ˆï¼‰ */
    .ocean-word {
        position: absolute;
        font-family: 'Noto Serif SC', serif;
        white-space: nowrap;
        opacity: 0;
        pointer-events: none;
        will-change: transform, opacity;
        /* å¢åŠ æ–‡å­—é˜´å½±ï¼Œé˜²æ­¢åœ¨æ·±è‰²æ³¢æµªä¸­çœ‹ä¸æ¸… */
        text-shadow: 0 2px 4px rgba(255,255,255,0.2);
    }

    @keyframes floatAndSink {
        0% { opacity: 0; transform: translateY(60px) scale(0.8) rotate(4deg); filter: blur(4px); }
        20% { opacity: 0.9; /* æé«˜ä¸é€æ˜åº¦ */ transform: translateY(0px) scale(1) rotate(0deg); filter: blur(0); }
        50% { opacity: 1; transform: translateY(-20px) scale(1) rotate(-2deg); filter: blur(0); }
        100% { opacity: 0; transform: translateY(80px) scale(0.9) rotate(4deg); filter: blur(8px); }
    }

    @media (prefers-reduced-motion: reduce) {
        *, *::before, *::after {
            animation-duration: 0.01ms !important;
            animation-iteration-count: 1 !important;
            transition-duration: 0.01ms !important;
            scroll-behavior: auto !important;
        }
    }
</style>
</head>
<body class="antialiased min-h-screen flex flex-col overflow-x-hidden text-[#2c3e50]">

    <audio id="bg-music" loop>
        <source src="./audio/bgm.mp3" type="audio/mpeg">
    </audio>

    <div id="ocean-container" class="fixed top-0 left-0 w-full h-full z-0 overflow-hidden pointer-events-none bg-gradient-to-b from-[#F9F8F6] via-[#eef2f3] to-[#dfe9f3]">
        <div class="wave-layer layer-3 absolute bottom-0 w-[200%] h-[40vh] opacity-30" style="animation-duration: 30s; z-index: 0;"></div>
        <div class="wave-layer layer-2 absolute bottom-[-20px] w-[200%] h-[40vh] opacity-50" style="animation-duration: 20s; z-index: 10;"></div>
        <div class="wave-layer layer-1 absolute bottom-[-50px] w-[200%] h-[40vh] opacity-80" style="animation-duration: 12s; z-index: 20;"></div>
    </div>

    <nav class="fixed top-0 w-full z-50 glass transition-all duration-300">
        <div class="max-w-5xl mx-auto px-6 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3 cursor-pointer group" onclick="location.reload()">
                <div class="w-12 h-12 relative overflow-hidden rounded-full border-2 border-[#2c3e50]/10 group-hover:border-[#5B7C99] transition-all duration-300 bg-white shadow-sm p-0.5">
                    <img src="./images/logo-silhouette.png" alt="Logo" class="w-full h-full object-cover object-center scale-115 group-hover:scale-125 transition-transform duration-500">
                </div>
                <span class="font-bold tracking-tight text-xl text-[#2c3e50] serif group-hover:text-[#5B7C99] transition-colors">OriginSight</span>
            </div>
            
            <div class="flex items-center gap-4">
                <div class="hidden md:flex items-center gap-6 text-sm text-gray-500 font-medium">
                    <button onclick="openPage('page-theory')" class="hover:text-[#5B7C99] transition">ç†è®ºæº¯æº</button>
                    <button onclick="openPage('page-privacy')" class="hover:text-[#5B7C99] transition">å…³äºéšç§</button>
                </div>
                
                <div class="flex items-center gap-2 group bg-white/50 backdrop-blur-sm rounded-full pl-1 pr-3 py-1 border border-gray-300 hover:border-[#5B7C99] transition-all duration-300">
                    <button id="audio-btn" type="button" onclick="toggleAudio()" class="w-8 h-8 rounded-full flex items-center justify-center text-gray-500 hover:text-[#5B7C99] transition" title="é™éŸ³/æ’­æ”¾" aria-pressed="false" aria-label="åˆ‡æ¢èƒŒæ™¯éŸ³ä¹æ’­æ”¾">
                        <svg id="icon-mute" class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" /><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" /></svg>
                        <svg id="icon-play" class="w-4 h-4 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M5.586 15H4a1 1 0 01-1-1v-4a1 1 0 011-1h1.586l4.707-4.707C10.923 3.663 12 4.109 12 5v14c0 .891-1.077 1.337-1.707.707L5.586 15z" /></svg>
                    </button>
                    
                    <input type="range" id="volume-slider" min="0" max="1" step="0.05" value="0.2" 
                    class="w-16 h-1 bg-gray-300 rounded-lg appearance-none cursor-pointer accent-[#5B7C99] opacity-50 group-hover:opacity-100 transition-opacity" 
                    oninput="changeVolume(this.value)" aria-label="èƒŒæ™¯éŸ³ä¹éŸ³é‡">
                </div>

                <button type="button" onclick="startQuiz()" id="nav-btn" class="text-sm bg-[#2c3e50] text-white px-5 py-2 rounded-full hover:bg-[#5B7C99] transition shadow-lg shadow-gray-200">å¼€å§‹æ¢ç´¢</button>
            </div>
        </div>
    </nav>

    <main id="page-landing" class="flex-1 relative z-10 flex flex-col items-center justify-center min-h-screen px-6 text-center">
        <div class="fade-in-up">
            <span class="inline-block py-1 px-3 rounded-full bg-gray-100 text-gray-500 text-xs font-bold tracking-widest mb-6">PERSONALITY & ORIGIN</span>
            <h1 class="text-5xl md:text-7xl font-bold mb-6 text-[#2c3e50] leading-tight">çœ‹è§è‡ªå·±ï¼Œ<br>æ˜¯æ”¹å˜çš„å¼€å§‹ã€‚</h1>
            <p class="text-xl md:text-2xl text-gray-500 font-light max-w-2xl mx-auto mb-12 serif leading-relaxed">
                ä½ çš„æ€§æ ¼å¹¶éå¤©ç”Ÿæ³¨å®šã€‚<br>
                é€šè¿‡æ·±åº¦å›æº¯ç«¥å¹´åœºæ™¯ï¼Œè§£ç åŸç”Ÿå®¶åº­ç•™ä¸‹çš„è¡Œä¸ºå°è®°ã€‚
            </p>
        </div>
        
        <div class="fade-in-up delay-100 flex flex-col sm:flex-row gap-4">
            <button type="button" onclick="startQuiz()" class="bg-[#5B7C99] text-white text-lg px-10 py-4 rounded-full font-medium hover:bg-[#4a6b8a] transition shadow-xl shadow-blue-900/10 transform hover:scale-105 duration-300">
                å¼€å§‹æ·±åº¦æµ‹è¯„
            </button>
        </div>
    </main>

    <main id="page-quiz" class="hidden flex-1 relative z-10 pt-24 pb-12 min-h-screen flex flex-col">
        <div class="fixed top-0 left-0 w-full h-1.5 bg-gray-200 z-[60]">
            <div id="progress-bar" class="h-full bg-[#5B7C99] w-0"></div>
        </div>
        <div class="max-w-2xl mx-auto w-full px-6 flex-1 flex flex-col justify-center">
            <div id="quiz-container" class="relative"></div>
        </div>
    </main>

    <main id="page-loading" class="hidden flex-1 relative z-10 flex flex-col items-center justify-center min-h-screen bg-white">
        <div class="w-16 h-16 border-4 border-gray-100 border-t-[#5B7C99] rounded-full animate-spin mb-8"></div>
        <h2 class="text-2xl font-bold text-[#2c3e50] mb-2 fade-in-up">æ­£åœ¨è¿æ¥æ½œæ„è¯†...</h2>
        <p id="loading-text" class="text-gray-400 font-mono text-sm fade-in-up delay-100">Analyzing Attachment Patterns...</p>
    </main>

    <main id="page-report" class="hidden flex-1 relative z-10 pt-24 pb-20 px-6 min-h-screen transition-colors duration-1000">
        <div class="max-w-6xl mx-auto" id="report-content"></div>
    </main>

    <main id="page-theory" class="hidden flex-1 relative z-10 pt-24 pb-20 px-6 min-h-screen">
        <div class="max-w-3xl mx-auto bg-white/80 backdrop-blur-md rounded-3xl p-8 md:p-12 shadow-xl border border-white/60">
            <button onclick="closeOverlay('page-theory')" class="mb-6 text-sm text-[#5B7C99] hover:underline flex items-center gap-1">
                â† è¿”å›
            </button>
            <h2 class="text-3xl font-bold text-[#2c3e50] mb-8 serif">ç†è®ºåŸºçŸ³</h2>
            
            <div class="space-y-8 text-gray-600 leading-relaxed">
                <div>
                    <h3 class="text-lg font-bold text-[#2c3e50] mb-2">1. ä¾æ‹ç†è®º (Attachment Theory)</h3>
                    <p>åŸºäºè‹±å›½å¿ƒç†å­¦å®¶ <strong>John Bowlby</strong> ä¸ <strong>Mary Ainsworth</strong> çš„ç»å…¸ç ”ç©¶ã€‚æˆ‘ä»¬ä¸ä»…ä»…å°†äººåˆ†ç±»ï¼Œè€Œæ˜¯åˆ†æä½ åœ¨äº²å¯†å…³ç³»ä¸­å¯¹äºâ€œå®‰å…¨æ„Ÿâ€å’Œâ€œå›é¿â€çš„æ½œæ„è¯†ååº”æœºåˆ¶ã€‚</p>
                </div>
                <div>
                    <h3 class="text-lg font-bold text-[#2c3e50] mb-2">2. è¨æäºšå®¶åº­æ²»ç–—æ¨¡å¼ (Satir Model)</h3>
                    <p>å¼•å…¥ Virginia Satir çš„å†°å±±ç†è®ºï¼Œåˆ†æä½ çš„â€œåº”å¯¹å§¿æ€â€ï¼ˆè®¨å¥½ã€æŒ‡è´£ã€è¶…ç†æ™ºã€æ‰“å²”ï¼‰ã€‚æˆ‘ä»¬å…³æ³¨çš„ä¸æ˜¯è´£æ€ªåŸç”Ÿå®¶åº­ï¼Œè€Œæ˜¯çœ‹è§é‚£äº›ä¸ºäº†ç”Ÿå­˜è€Œå‘å±•å‡ºçš„é˜²å¾¡æœºåˆ¶ã€‚</p>
                </div>
                <div>
                    <h3 class="text-lg font-bold text-[#2c3e50] mb-2">3. å®¢ä½“å…³ç³»ç†è®º (Object Relations)</h3>
                    <p>åˆ†æä½ çš„â€œå†…åœ¨çˆ¶æ¯â€å½¢è±¡æ˜¯å¦‚ä½•æŠ•å°„åˆ°ç°åœ¨çš„ä¼´ä¾£ã€æœ‹å‹ç”šè‡³è‡ªå·±èº«ä¸Šçš„ã€‚çœ‹è§å³æ˜¯ç–—æ„ˆçš„å¼€å§‹ã€‚</p>
                </div>
            </div>
        </div>
    </main>

    <main id="page-privacy" class="hidden flex-1 relative z-10 pt-24 pb-20 px-6 min-h-screen">
        <div class="max-w-3xl mx-auto bg-white/80 backdrop-blur-md rounded-3xl p-8 md:p-12 shadow-xl border border-white/60">
            <button onclick="closeOverlay('page-privacy')" class="mb-6 text-sm text-[#5B7C99] hover:underline flex items-center gap-1">
                â† è¿”å›
            </button>
            <h2 class="text-3xl font-bold text-[#2c3e50] mb-8 serif">éšç§æ‰¿è¯º</h2>
            
            <div class="bg-green-50 p-6 rounded-2xl border border-green-100 mb-8 flex items-start gap-4">
                <span class="text-2xl">ğŸ”’</span>
                <div>
                    <h4 class="font-bold text-[#27ae60] mb-1">æœ¬åœ°è®¡ç®—ï¼Œæ•°æ®ä¸å‡ºè®¾å¤‡</h4>
                    <p class="text-sm text-gray-600">OriginSight æ˜¯ä¸€ä¸ªçº¯å‰ç«¯åº”ç”¨ï¼ˆClient-side Appï¼‰ã€‚</p>
                </div>
            </div>

            <div class="space-y-4 text-gray-600 text-sm leading-loose">
                <p><strong>1. æ•°æ®å­˜å‚¨ï¼š</strong> æ‚¨çš„æµ‹è¯•ç»“æœä»…å­˜å‚¨åœ¨æ‚¨å½“å‰æµè§ˆå™¨çš„ <code>Local Storage</code> ä¸­ã€‚è¿™æ„å‘³ç€å¦‚æœæ‚¨æ›´æ¢è®¾å¤‡æˆ–æ¸…é™¤æµè§ˆå™¨ç¼“å­˜ï¼Œæ•°æ®å°†ä¼šæ¶ˆå¤±ã€‚æˆ‘ä»¬æ²¡æœ‰æœåŠ¡å™¨ï¼Œä¹Ÿå°±æ— æ³•çª¥æ¢æ‚¨çš„ç§˜å¯†ã€‚</p>
                <p><strong>2. åŒ¿åæ€§ï¼š</strong> æˆ‘ä»¬ä¸æ”¶é›†ä»»ä½•å§“åã€æ‰‹æœºå·æˆ–èº«ä»½ä¿¡æ¯ã€‚</p>
                <p><strong>3. æºä»£ç é€æ˜ï¼š</strong> é¡µé¢ä»£ç å®Œå…¨è¿è¡Œåœ¨æ‚¨çš„æµè§ˆå™¨ä¸­ï¼Œæ‚¨å¯ä»¥éšæ—¶å®¡æŸ¥ä»£ç é€»è¾‘ã€‚</p>
            </div>
        </div>
    </main>
<script>
    // ================= çº¯ä»£ç éŸ³é¢‘åˆæˆå¼•æ“ (Web Audio API) =================
    // ä¸éœ€è¦ä»»ä½•å¤–éƒ¨æ–‡ä»¶ï¼Œç›´æ¥ç”¨ä»£ç ç”Ÿæˆç™½å™ªéŸ³
    // ================= æ··åˆéŸ³é¢‘å¼•æ“ (MP3èƒŒæ™¯ä¹ + WebAudioéŸ³æ•ˆ) =================
    const AudioEngine = {
        ctx: null, // ç”¨äºç”Ÿæˆæ‰‘é€šå£°çš„ä¸Šä¸‹æ–‡
        isMuted: true, // é»˜è®¤é™éŸ³

        // åˆå§‹åŒ– Web Audio Context (ä»…ç”¨äºæ‰‘é€šå£°)
        init: function() {
            if (!this.ctx) {
                const AudioContext = window.AudioContext || window.webkitAudioContext;
                this.ctx = new AudioContext();
            }
        },

        // åˆ‡æ¢èƒŒæ™¯éŸ³ä¹æ’­æ”¾/æš‚åœ
        toggleMute: function() {
            this.init(); // ç¡®ä¿éŸ³æ•ˆä¸Šä¸‹æ–‡ä¹Ÿåˆå§‹åŒ–
            this.isMuted = !this.isMuted;
            
            const audioTag = document.getElementById('bg-music');
            const iconMute = document.getElementById('icon-mute');
            const iconPlay = document.getElementById('icon-play');
            const audioBtn = document.getElementById('audio-btn');

            if (this.isMuted) {
                // é™éŸ³
                if(audioTag) audioTag.pause();
                if(iconMute) iconMute.classList.remove('hidden');
                if(iconPlay) iconPlay.classList.add('hidden');
                if(audioBtn) audioBtn.setAttribute('aria-pressed', 'false');
            } else {
                // æ’­æ”¾
                if(audioTag) {
                   const slider = document.getElementById('volume-slider');
                    audioTag.volume = slider ? slider.value : 0.2;
                    const playPromise = audioTag.play();
                    if (playPromise !== undefined) {
                        playPromise.catch(error => {
                            console.log("è‡ªåŠ¨æ’­æ”¾è¢«é˜»æ­¢ï¼Œéœ€ç”¨æˆ·äº¤äº’:", error);
                        });
                    }
                }
                
                // æ¢å¤éŸ³æ•ˆä¸Šä¸‹æ–‡
                if(this.ctx && this.ctx.state === 'suspended') {
                    this.ctx.resume();
                }

                if(iconMute) iconMute.classList.add('hidden');
                if(iconPlay) iconPlay.classList.remove('hidden');
                if(audioBtn) audioBtn.setAttribute('aria-pressed', 'true');
            }
        },

        // å…¼å®¹æ—§ä»£ç è°ƒç”¨ï¼Œé˜²æ­¢æŠ¥é”™ (MP3æ¨¡å¼ä¸‹ä¸éœ€è¦åŠ¨æ€æ”¹å˜ç¯å¢ƒéŸ³ï¼Œä½†ä¿ç•™æ¥å£)
        playAmbience: function(type) {
            // åœ¨ MP3 æ¨¡å¼ä¸‹ï¼Œè¿™ä¸ªå‡½æ•°ä¸éœ€è¦åšå¤æ‚çš„ç™½å™ªéŸ³ç”Ÿæˆ
            // åªéœ€è¦ç¡®ä¿å¦‚æœæ²¡é™éŸ³ï¼ŒéŸ³ä¹åœ¨å“å³å¯
            if (!this.isMuted) {
                const audioTag = document.getElementById('bg-music');
                if(audioTag && audioTag.paused) audioTag.play().catch(e=>{});
            }
        },

        // æ¨¡æ‹Ÿç‰©ä½“è½æ°´çš„å£°éŸ³ (ä¿ç•™ä¹‹å‰çš„ Web Audio API å®ç°)
        playSplash: function() {
            if (this.isMuted) return;
            this.init();
            if (this.ctx.state === 'suspended') this.ctx.resume();

            const t = this.ctx.currentTime;
            
            // ç¬¬ä¸€å±‚ï¼šå†²å‡»éŸ³
            const osc1 = this.ctx.createOscillator();
            const gainOsc1 = this.ctx.createGain();
            const filterOsc1 = this.ctx.createBiquadFilter();
            
            osc1.type = 'sine';
            osc1.frequency.setValueAtTime(280, t);
            osc1.frequency.exponentialRampToValueAtTime(100, t + 0.22);
            filterOsc1.type = 'lowpass';
            filterOsc1.frequency.setValueAtTime(1200, t);
            filterOsc1.frequency.linearRampToValueAtTime(700, t + 0.22);
            gainOsc1.gain.setValueAtTime(0, t);
            gainOsc1.gain.linearRampToValueAtTime(0.6, t + 0.04);
            gainOsc1.gain.exponentialRampToValueAtTime(0.1, t + 0.22);
            
            osc1.connect(filterOsc1);
            filterOsc1.connect(gainOsc1);
            gainOsc1.connect(this.ctx.destination);
            osc1.start(t);
            osc1.stop(t + 0.25);
            
            // ç¬¬äºŒå±‚ï¼šæ°´å£°å…±é¸£
            const osc2 = this.ctx.createOscillator();
            const gainOsc2 = this.ctx.createGain();
            const filterOsc2 = this.ctx.createBiquadFilter();
            
            osc2.type = 'sine';
            osc2.frequency.setValueAtTime(110, t + 0.07);
            osc2.frequency.exponentialRampToValueAtTime(45, t + 0.4);
            filterOsc2.type = 'lowpass';
            filterOsc2.frequency.setValueAtTime(600, t);
            filterOsc2.frequency.linearRampToValueAtTime(250, t + 0.35);
            gainOsc2.gain.setValueAtTime(0, t + 0.07);
            gainOsc2.gain.linearRampToValueAtTime(0.5, t + 0.12);
            gainOsc2.gain.exponentialRampToValueAtTime(0.03, t + 0.45);
            
            osc2.connect(filterOsc2);
            filterOsc2.connect(gainOsc2);
            gainOsc2.connect(this.ctx.destination);
            osc2.start(t + 0.07);
            osc2.stop(t + 0.45);
        },
    };

// --- é¢˜åº“ v5.0ï¼šçµé­‚æ‹·é—®ç‰ˆ (åŸºäºâ€œå¥‡å¹»æ—¥â€æ·±åº¦é€»è¾‘) ---
    const questions = [
        // ==================== ç¬¬ä¸€é˜¶æ®µï¼šç”Ÿå­˜ç­–ç•¥ä¸å®¶åº­ç»“æ„ (The Imprint) ====================
        { 
            id: 1, 
            scene: "é‡‘é’±ä¸çˆ±", 
            text: "ç«¥å¹´æ—¶ï¼Œå½“ä½ éœ€è¦é’±æˆ–è€…æƒ³ä¹°ä¸€æ ·å–œæ¬¢çš„ä¸œè¥¿æ—¶ï¼Œçˆ¶æ¯é€šå¸¸çš„ååº”æ˜¯ï¼Ÿ", 
            options: [ 
                { text: "ç›´æ¥æ»¡è¶³ï¼Œå¹¶å‘Šè¯‰æˆ‘â€œæˆ‘ä»¬èµšé’±å°±æ˜¯ä¸ºäº†è®©ä½ è¿‡å¾—å¥½â€ã€‚", score: { secure: 2, deservability: 2 } }, 
                { text: "å¯ä»¥ä¹°ï¼Œä½†å¿…é¡»ä»¥â€œè€ƒåˆ°å¥½æˆç»©â€æˆ–â€œå¬è¯â€ä¸ºäº¤æ¢æ¡ä»¶ã€‚", score: { anxiety: 2, conditionalLove: 3 } }, 
                { text: "ä¸€è¾¹ç»™é’±ä¸€è¾¹è¯‰è‹¦ï¼šâ€œæˆ‘ä»¬èˆä¸å¾—åƒç©¿å…¨ç»™ä½ äº†ï¼Œä½ è¦æ‡‚äº‹å•Šâ€ã€‚", score: { guilt: 3, rescuer: 2, anxiety: 1 } }, 
                { text: "ä¹ æƒ¯æ€§æ‹’ç»ï¼Œå¹¶ç¾è¾±æˆ‘çš„æ¬²æœ›ï¼šâ€œä½ æ€ä¹ˆè¿™ä¹ˆè™šè£/æµªè´¹ï¼Ÿâ€", score: { trauma: 2, shame: 3, avoid: 1 } },
                { text: "æˆ‘ä¼šå°½é‡ä¸æéœ€æ±‚ï¼Œå› ä¸ºä¸æƒ³çœ‹åˆ°ä»–ä»¬ä¸ºéš¾æˆ–åµæ¶çš„æ ·å­ã€‚", score: { avoid: 2, sentinel: 2 } } 
            ] 
        },
        { 
            id: 2, 
            scene: "çˆ¶äº²çš„ä½é˜¶", 
            text: "åœ¨é‚£ä¸ªå®¶é‡Œï¼Œå…³äºâ€œçˆ¶äº²â€è¿™ä¸ªè§’è‰²ï¼Œä½ æœ€çœŸå®çš„èº«ä½“è®°å¿†æ˜¯ï¼Ÿ", 
            options: [ 
                { text: "ä»–æ˜¯ä¸€åº§å±±ï¼Œæ—¢æœ‰åŠ›é‡ä¿æŠ¤æˆ‘ï¼Œä¹Ÿèƒ½æ¸©å’Œåœ°æ²Ÿé€šã€‚", score: { secure: 2 } }, 
                { text: "ä»–æ˜¯â€œéšå½¢äººâ€ï¼Œé™¤äº†èµšé’±æˆ–çœ‹ç”µè§†ï¼Œå‡ ä¹åœ¨æƒ…æ„Ÿä¸Šç¼ºå¸­ã€‚", score: { avoid: 2, absentFather: 3, neglect: 1 } }, 
                { text: "ä»–æ˜¯æ¯äº²æŠ±æ€¨çš„å¯¹è±¡ï¼Œæˆ‘æ„Ÿè§‰æˆ‘å¿…é¡»ä»£æ›¿ä»–å»å®‰æŠšæ¯äº²çš„æƒ…ç»ªã€‚", score: { parentification: 3, spiritualHusband: 3, anxiety: 2 } }, 
                { text: "ä»–æ˜¯ææƒ§çš„æ¥æºï¼Œå…¨å®¶äººéƒ½è¦æˆ˜æˆ˜å…¢å…¢åœ°å›´ç€ä»–çš„æƒ…ç»ªè½¬ã€‚", score: { trauma: 3, fear: 2, sentinel: 2 } },
                { text: "ä»–å¾ˆä¸¥å‰ï¼Œåªæœ‰å½“æˆ‘è¶³å¤Ÿä¼˜ç§€æ—¶ï¼Œä»–æ‰ä¼šæ­£çœ¼çœ‹æˆ‘ã€‚", score: { superReason: 2, perfectionism: 2 } }
            ] 
        },
        { 
            id: 3, 
            scene: "æƒ…ç»ªçš„åƒåœ¾æ¡¶", 
            text: "å½“æ¯äº²ï¼ˆæˆ–æŠšå…»è€…ï¼‰å‘ä½ è¯‰è‹¦ï¼Œè¯´å¥¹è¿‡å¾—æœ‰å¤šä¸å¹¸æ—¶ï¼Œä½ çš„æ„Ÿè§‰æ˜¯ï¼Ÿ", 
            options: [ 
                { text: "è¿™ç§æƒ…å†µå¾ˆå°‘å‘ç”Ÿï¼Œå¤§äººçš„äº‹ä»–ä»¬è‡ªå·±è§£å†³ã€‚", score: { secure: 2, boundary: 2 } }, 
                { text: "æå…¶æ²‰é‡ï¼Œè§‰å¾—æ˜¯å› ä¸ºæˆ‘ä¸å¤Ÿå¥½ï¼Œæ‰è®©å¦ˆå¦ˆè¿™ä¹ˆè¾›è‹¦ã€‚", score: { shame: 2, rescuer: 3, anxiety: 2 } }, 
                { text: "æ„¤æ€’åˆæ— åŠ›ï¼Œæƒ³é€ƒç¦»ä½†åˆè§‰å¾—é‚£æ˜¯èƒŒå›ï¼Œå†…å¿ƒè¢«æ’•è£‚ã€‚", score: { chaos: 2, guilt: 2 } }, 
                { text: "éº»æœ¨ï¼Œå·¦è€³è¿›å³è€³å‡ºï¼Œå­¦ä¼šäº†è‡ªåŠ¨å±è”½ã€‚", score: { avoid: 3, numb: 2 } },
                { text: "æˆ‘ä¼šç†æ€§åœ°å¸®å¥¹åˆ†æå¯¹é”™ï¼Œåƒä¸ªå°å¤§äººä¸€æ ·ç»™å¥¹å‡ºä¸»æ„ã€‚", score: { superReason: 3, parentification: 2 } }
            ] 
        },
        { 
            id: 4, 
            scene: "è¢«é˜‰å‰²çš„ç”Ÿå‘½åŠ›", 
            text: "å½“ä½ è¡¨ç°å‡ºæƒ³è¦äº‰ç¬¬ä¸€ã€æƒ³è¦èµ¢ï¼Œæˆ–è€…å¯¹æŸæ ·ä¸œè¥¿è¡¨ç°å‡ºæå¼ºå æœ‰æ¬²æ—¶ï¼Ÿ", 
            options: [ 
                { text: "çˆ¶æ¯ä¼šé¼“åŠ±æˆ‘çš„é‡å¿ƒï¼Œå‘Šè¯‰æˆ‘â€œå»äº‰å–å§â€ã€‚", score: { secure: 2, blackVitality: 2 } }, 
                { text: "ä¼šè¢«æ‰“å‹ï¼šâ€œæªæ‰“å‡ºå¤´é¸Ÿï¼Œåšäººè¦ä½è°ƒ/è€å®ç‚¹ã€‚â€", score: { avoid: 2, repress: 3 } }, 
                { text: "ä¼šè¢«å˜²è®½ï¼šâ€œå°±å‡­ä½ ï¼Ÿåˆ«åšæ¢¦äº†ã€‚â€", score: { trauma: 2, shame: 2 } }, 
                { text: "ä»–ä»¬ä¸åœ¨ä¹æˆ‘æƒ³èµ¢ä»€ä¹ˆï¼Œåªåœ¨ä¹æˆ‘èµ¢äº†èƒ½ä¸èƒ½ç»™ä»–ä»¬é•¿è„¸ã€‚", score: { narcissism: 2, objectified: 2 } },
                { text: "æˆ‘ä¼šä¸‹æ„è¯†åœ°æŠŠè¿™ç§æ¬²æœ›è—èµ·æ¥ï¼Œè¡¨ç°å¾—â€œä¸ä¸–æ— äº‰â€ã€‚", score: { placate: 3, mask: 2 } }
            ] 
        },
        { 
            id: 5, 
            scene: "çŠ¯é”™çš„å®¡åˆ¤", 
            text: "å¦‚æœä¸å°å¿ƒæ‰“ç¢äº†è´µé‡ç‰©å“ï¼Œåœ¨é‚£ä¸€ç¬é—´ï¼Œä½ ä¸‹æ„è¯†çš„ååº”æ˜¯ï¼Ÿ", 
            options: [ 
                { text: "æœ‰ç‚¹æ…Œï¼Œä½†çŸ¥é“å¦‚å®è¯´å‡ºæ¥ä¼šè¢«åŸè°…ã€‚", score: { secure: 2 } }, 
                { text: "è„‘å­ä¸€ç‰‡ç©ºç™½ï¼Œè§‰å¾—è‡ªå·±â€œæ­»å®šäº†â€ï¼Œææƒ§æ„Ÿç¬é—´æ·¹æ²¡å…¨èº«ã€‚", score: { trauma: 3, fear: 3 } }, 
                { text: "ç«‹åˆ»æƒ³å€Ÿå£æ¨å¸è´£ä»»ï¼Œæˆ–è€…æ’’è°è¯´æ˜¯åˆ«äººå¼„çš„ã€‚", score: { avoid: 2, defense: 2 } }, 
                { text: "ç–¯ç‹‚åœ°æƒ³åŠæ³•å¼¥è¡¥æˆ–æ¸…ç†ï¼Œè¯•å›¾åœ¨ä»–ä»¬å‘ç°å‰æŠ¹å»ç—•è¿¹ã€‚", score: { anxiety: 2, perfectionism: 2, sentinel: 1 } },
                { text: "å‡†å¤‡å¥½è¿æ¥ä¸€åœºé•¿è¾¾æ•°å°æ—¶çš„è¯´æ•™å’Œç¾è¾±ã€‚", score: { avoid: 1, shame: 2 } }
            ] 
        },
        { 
            id: 6, 
            scene: "éšç§ä¸è¾¹ç•Œ", 
            text: "å…³äºä½ çš„æ—¥è®°æœ¬ã€æ‰‹æœºæˆ–æˆ¿é—¨ï¼ŒçœŸå®çš„çŠ¶å†µæ˜¯ï¼Ÿ", 
            options: [ 
                { text: "æˆ‘æœ‰ç»å¯¹çš„éšç§ï¼Œä»–ä»¬è¿›é—¨å‰ä¼šæ•²é—¨å¹¶ç­‰å¾…ã€‚", score: { secure: 2 } }, 
                { text: "æˆ¿é—¨ä¸èƒ½é”ï¼Œé”äº†å°±æ˜¯â€œå¿ƒé‡Œæœ‰é¬¼â€æˆ–â€œä¸æŠŠçˆ¶æ¯å½“äººâ€ã€‚", score: { intrusion: 3, enmesh: 2 } }, 
                { text: "åä¹‰ä¸Šæœ‰éšç§ï¼Œä½†ä»–ä»¬ä¼šè¶æˆ‘ä¸åœ¨æ—¶ç¿»çœ‹ï¼Œç¾å…¶åæ›°â€œå…³å¿ƒâ€ã€‚", score: { anxiety: 2, trustIssues: 2 } }, 
                { text: "ä»–ä»¬æ ¹æœ¬ä¸å…³æ³¨æˆ‘åœ¨å¹²å˜›ï¼Œæˆ‘æ¶ˆå¤±ä¸€å¤©ä¹Ÿæ²¡äººå‘ç°ã€‚", score: { avoid: 2, neglect: 3 } },
                { text: "æˆ‘å­¦ä¼šäº†åä¾¦å¯Ÿï¼ŒæŠŠç§˜å¯†è—åœ¨ä»–ä»¬ç»å¯¹æƒ³ä¸åˆ°çš„åœ°æ–¹ã€‚", score: { independent: 2, avoid: 1 } }
            ] 
        },

        // ==================== ç¬¬äºŒé˜¶æ®µï¼šæˆå¹´æŠ•å°„ä¸ä»£å¿ (The Pattern) ====================
        { 
            id: 7, 
            scene: "å…³ç³»çš„è½½ä½“", 
            text: "åœ¨ä¸€æ®µäº²å¯†å…³ç³»ä¸­ï¼Œä½ æœ€åº•å±‚çš„å¿ƒç†åŠ¨åŠ›å¾€å¾€æ˜¯ï¼Ÿ", 
            options: [ 
                { text: "åˆ†äº«ç”Ÿæ´»ï¼Œå…±åŒæˆé•¿ï¼Œå½¼æ­¤ç‹¬ç«‹ã€‚", score: { secure: 2 } }, 
                { text: "åƒæººæ°´çš„äººæŠ“ä½æµ®æœ¨ï¼Œå¯¹æ–¹çš„è®¤å¯è®©æˆ‘æ„Ÿåˆ°â€œæˆ‘è¿˜æ´»ç€â€ã€‚", score: { anxiety: 3, aliveCarrier: 3 } }, 
                { text: "ä¿æŒå®‰å…¨è·ç¦»ï¼Œå¯¹æ–¹é å¾—å¤ªè¿‘ä¼šè®©æˆ‘æ„Ÿåˆ°è¢«åå™¬/çª’æ¯ã€‚", score: { avoid: 3, spiritualIndependence: 2 } }, 
                { text: "ä¸€ç§éšæ—¶å‡†å¤‡å¥½è¢«æŠ›å¼ƒçš„è­¦è§‰ï¼Œæ‰€ä»¥æˆ‘ä»ä¸æŠ•å…¥ç™¾åˆ†ç™¾çš„çœŸå¿ƒã€‚", score: { fear: 3, distrust: 2, trauma: 1 } },
                { text: "é€šè¿‡ä¸æ–­åœ°ç…§é¡¾/æ‹¯æ•‘å¯¹æ–¹ï¼Œæ¥ç¡®è®¤è‡ªå·±çš„ä»·å€¼ã€‚", score: { placate: 2, rescuer: 3 } }
            ] 
        },
        { 
            id: 8, 
            scene: "æˆç†Ÿçš„æ‰§å¿µ", 
            text: "æƒ³åˆ°é‚£äº›å¹´çˆ¶æ¯å¯¹ä½ çš„ä¼¤å®³ï¼Œä½ ç°åœ¨çš„çœŸå®æ€åº¦æ˜¯ï¼Ÿ", 
            options: [ 
                { text: "å·²ç»é‡Šç„¶ï¼Œæˆ‘ä¸å†æœŸå¾…ä»–ä»¬çš„é“æ­‰ï¼Œæˆ‘çš„æœªæ¥ç”±æˆ‘å®šä¹‰ã€‚", score: { secure: 2, maturity: 3 } }, 
                { text: "ä¸€ç›´è€¿è€¿äºæ€€ï¼Œæ¸´æœ›å¬åˆ°ä»–ä»¬äº²å£æ‰¿è®¤å½“å¹´é”™äº†ï¼Œæ¸´æœ›è¢«è¡¥å¿ã€‚", score: { anxiety: 3, expectation: 2 } }, 
                { text: "å®Œå…¨ä¸æ„¿æèµ·ï¼Œå¼ºè¿«è‡ªå·±ä¸å»æƒ³ï¼Œä½†è¿™æˆäº†æˆ‘å†…å¿ƒçš„é›·åŒºã€‚", score: { avoid: 2, suppress: 3 } }, 
                { text: "é€šè¿‡ä¸æ–­åœ°è´¬ä½ä»–ä»¬æˆ–æƒ©ç½šè‡ªå·±ï¼Œæ¥å‘æ³„é‚£ç§æ„¤æ€’ã€‚", score: { trauma: 2, anger: 2 } },
                { text: "è§‰å¾—ä»–ä»¬ä¹Ÿæ˜¯å—å®³è€…ï¼Œè¯•å›¾ç”¨â€œçˆ±â€å»æ„ŸåŒ–æˆ–æ‹¯æ•‘ä»–ä»¬ã€‚", score: { placate: 2, rescuer: 2 } }
            ] 
        },
        { 
            id: 9, 
            scene: "èƒ½é‡æ¶ˆè€—", 
            text: "å¤„ç†æ·±å±‚çš„æƒ…æ„Ÿäº¤æµï¼ˆå¦‚è°ˆå¿ƒã€è§£å†³å†²çªï¼‰å¯¹ä½ æ¥è¯´ï¼Ÿ", 
            options: [ 
                { text: "è™½ç„¶æœ‰æŒ‘æˆ˜ï¼Œä½†èƒ½å¸¦æ¥èƒ½é‡å’Œæ›´æ·±çš„äº²å¯†åº¦ã€‚", score: { secure: 2 } }, 
                { text: "æ˜¯ä¸€åœºæ¶ˆè€—å·¨å¤§çš„é©¬æ‹‰æ¾ï¼Œæˆ‘åªæƒ³å¿«ç‚¹ç»“æŸï¼Œé€ƒå›è‡ªå·±çš„æ´ç©´ã€‚", score: { avoid: 3, energyDrain: 2 } }, 
                { text: "æ˜¯ä¸€åœºå®¡åˆ¤ï¼Œæˆ‘éå¸¸å®³æ€•è‡ªå·±è¯´é”™è¯è¢«å¯¹æ–¹å¦å®š/æŠ›å¼ƒã€‚", score: { anxiety: 3, fear: 1 } }, 
                { text: "æˆ‘åªä¼šåˆ†æé€»è¾‘ï¼Œæ— æ³•ç†è§£ä¸ºä»€ä¹ˆè¿™ç§äº‹è¦æå¾—è¿™ä¹ˆæƒ…ç»ªåŒ–ã€‚", score: { superReason: 3, numb: 2 } },
                { text: "æˆ‘ä¼šå…ˆå‘åˆ¶äººï¼Œç”¨æ„¤æ€’æˆ–æŒ‡è´£æ¥é˜²å¾¡ï¼Œé¿å…è‡ªå·±å—ä¼¤ã€‚", score: { blame: 2, defense: 2 } }
            ] 
        },
        { 
            id: 10, 
            scene: "é¢å¯¹æ„¤æ€’", 
            text: "åœ¨äº²å¯†å…³ç³»ä¸­ï¼Œå¦‚æœä½ æ„Ÿåˆ°æ„¤æ€’æˆ–ä¸æ»¡ï¼Œé€šå¸¸ä¼šæ€ä¹ˆåšï¼Ÿ", 
            options: [ 
                { text: "ç›´æ¥è¡¨è¾¾æˆ‘çš„æ„¤æ€’å’ŒåŸå› ï¼Œå¯»æ±‚è§£å†³ã€‚", score: { secure: 2, blackVitality: 1 } }, 
                { text: "æŠŠæ„¤æ€’å‹ä¸‹å»ï¼Œç”Ÿé—·æ°”ï¼ˆå†·æš´åŠ›ï¼‰ï¼Œå¸Œæœ›å¯¹æ–¹èƒ½çŒœåˆ°å¹¶æ¥å“„æˆ‘ã€‚", score: { anxiety: 2, passiveAggressive: 3 } }, 
                { text: "ç«‹åˆ»åˆ‡æ–­è”ç³»ï¼ŒåƒåˆºçŒ¬ä¸€æ ·ç¼©èµ·æ¥ï¼Œç›´åˆ°å¿ƒæƒ…å¹³å¤ã€‚", score: { avoid: 3, control: 1 } }, 
                { text: "ç¬é—´çˆ†å‘ï¼Œè¯´å¾ˆå¤šä¼¤äººçš„è¯ï¼Œäº‹ååˆé™·å…¥æ·±æ·±çš„åæ‚”ã€‚", score: { chaos: 2, fear: 1 } },
                { text: "ç¬‘ç€è¯´â€œæ²¡äº‹â€ï¼Œä½†åœ¨å¿ƒé‡Œé»˜é»˜æ‰£åˆ†ï¼Œæ‰£å®Œå°±ç¦»å¼€ã€‚", score: { avoid: 2, mask: 2 } }
            ] 
        },
        { 
            id: 11, 
            scene: "æ±‚åŠ©æœºåˆ¶", 
            text: "å½“ä½ é‡åˆ°éš¾ä»¥ç‹¬è‡ªè§£å†³çš„å›°éš¾æ—¶ï¼Œå‘åˆ«äººå¼€å£æ±‚åŠ©å¯¹ä½ æ¥è¯´ï¼Ÿ", 
            options: [ 
                { text: "å¾ˆè‡ªç„¶ï¼Œæˆ‘ç›¸ä¿¡è¿™ä¸ä¼šç ´åå…³ç³»ï¼Œæˆ‘ä¹Ÿä¹æ„å¸®å›å»ã€‚", score: { secure: 2 } }, 
                { text: "æéš¾ï¼Œæˆ‘è§‰å¾—é‚£æ˜¯ç¤ºå¼±ï¼Œæˆ–è€…ä¸æƒ³æ¬ äººæƒ…ï¼Œå®æ„¿è‡ªå·±æ‰›ã€‚", score: { avoid: 3, independent: 3 } }, 
                { text: "æˆ‘ä¼šåå¤ç¡®è®¤å¯¹æ–¹æ˜¯å¦æ–¹ä¾¿ï¼Œæå…¶æ€•ç»™äººæ·»éº»çƒ¦ï¼Œè§‰å¾—è‡ªå·±æ˜¯ä¸ªè´Ÿæ‹…ã€‚", score: { anxiety: 2, placate: 3, shame: 1 } }, 
                { text: "æˆ‘åªå‘ç‰¹å®šçš„äººæ±‚åŠ©ï¼Œä¸”å¦‚æœè¢«æ‹’ç»ï¼Œæˆ‘ä¼šè§‰å¾—è¢«å…¨ä¸–ç•ŒæŠ›å¼ƒã€‚", score: { depend: 3, fear: 2 } },
                { text: "æˆ‘ä¼šç”¨é‡‘é’±æˆ–åˆ©ç›Šäº¤æ¢æ¥è§£å†³ï¼Œè¿™æ ·äº’ä¸ç›¸æ¬ æœ€å®‰å…¨ã€‚", score: { superReason: 2, transaction: 2 } }
            ] 
        },
        { 
            id: 12, 
            scene: "ç”šè‡³ä¸æ•¢å¿«ä¹", 
            text: "å½“ä½ æ— æ‰€äº‹äº‹åœ°èººç€ï¼Œæˆ–è€…æ­£åœ¨äº«å—çº¯ç²¹çš„å¨±ä¹æ—¶ï¼Œä½ ä¼šæ„Ÿåˆ°ï¼Ÿ", 
            options: [ 
                { text: "æ”¾æ¾å’Œæƒ¬æ„ï¼Œè¿™æ˜¯æˆ‘åº”å¾—çš„ä¼‘æ¯ã€‚", score: { secure: 2, deservability: 2 } }, 
                { text: "è«åçš„ç„¦è™‘ï¼Œè§‰å¾—æˆ‘åº”è¯¥å»åšç‚¹â€œæ­£äº‹â€ï¼Œå¦åˆ™å°±è¢«è½ä¸‹äº†ã€‚", score: { anxiety: 2, perfectionism: 2 } }, 
                { text: "ç©ºè™šï¼Œä¸çŸ¥é“å¦‚æœä¸å·¥ä½œ/å­¦ä¹ ï¼Œå¦‚æœä¸â€œæœ‰ç”¨â€ï¼Œæˆ‘æ˜¯è°ã€‚", score: { numb: 2, lowSelfEsteem: 2 } }, 
                { text: "ä¸€ç§éšéšçš„ç½ªæ¶æ„Ÿï¼Œä»¿ä½›æˆ‘è¿‡å¾—å¤ªèˆ’æœæ˜¯å¯¹è¾›è‹¦çˆ¶æ¯çš„èƒŒå›ã€‚", score: { guilt: 3, enmesh: 2 } },
                { text: "æˆ‘ä¼šå¼ºè¿«è‡ªå·±çœ‹æœ‰æ•™è‚²æ„ä¹‰çš„çºªå½•ç‰‡ï¼Œè¿ä¼‘æ¯éƒ½è¦â€œæœ‰æ„ä¹‰â€ã€‚", score: { superReason: 2, control: 2 } }
            ] 
        },

        // ==================== ç¬¬ä¸‰é˜¶æ®µï¼šè‡ªæˆ‘é‡æ„ (The Reconstruction) ====================
        { 
            id: 13, 
            scene: "èº«ä½“çš„è®°å¿†", 
            text: "å¯¹äºä»–äººçš„è‚¢ä½“è§¦ç¢°ï¼ˆå¦‚æ‹¥æŠ±ã€æ‹è‚©ã€é è¿‘ï¼‰ï¼Œä½ çš„æœ¬èƒ½ååº”æ˜¯ï¼Ÿ", 
            options: [ 
                { text: "æ„Ÿåˆ°è‡ªç„¶æ¸©æš–ï¼Œèƒ½é€šè¿‡æ¥è§¦è·å¾—èƒ½é‡ã€‚", score: { secure: 2 } }, 
                { text: "åƒµç¡¬ã€ä¸è‡ªåœ¨ï¼Œæœ¬èƒ½åœ°æƒ³èº²é—ªï¼Œå“ªæ€•æ˜¯ç†Ÿäººã€‚", score: { avoid: 3, trauma: 1 } }, 
                { text: "æ¸´æœ›æ‹¥æŠ±ï¼Œä½†åˆä¸æ•¢ä¸»åŠ¨ç´¢å–ï¼Œæ€•è¢«æ‹’ç»ã€‚", score: { anxiety: 2, shame: 1 } }, 
                { text: "å¦‚æœæ˜¯éå¸¸äº²å¯†çš„äººå¯ä»¥ï¼Œä½†ä¸å–œæ¬¢çªå¦‚å…¶æ¥çš„è§¦ç¢°ã€‚", score: { secure: 1, boundary: 1 } },
                { text: "æˆ‘å¯ä»¥ç¤¼è²Œæ€§åœ°æ‹¥æŠ±ï¼Œä½†å†…å¿ƒå…¶å®æ˜¯éº»æœ¨çš„ï¼Œåƒåœ¨å®Œæˆç¤¾äº¤ä»»åŠ¡ã€‚", score: { mask: 3, numb: 1 } }
            ] 
        },
        { 
            id: 14, 
            scene: "å…¨å¤©å€™å“¨å…µ", 
            text: "å¦‚æœèº«è¾¹çš„äººï¼ˆä¼´ä¾£/åŒäº‹ï¼‰çœ‹èµ·æ¥è„¸è‰²ä¸å¥½æˆ–å¹æ°”ï¼Œä½ çš„ç¬¬ä¸€ååº”æ˜¯ï¼Ÿ", 
            options: [ 
                { text: "è¯¢é—®å‘ç”Ÿäº†ä»€ä¹ˆï¼Œå¹¶ç»™äºˆé€‚å½“çš„å…³å¿ƒï¼Œä½†ä¸è§‰å¾—æ˜¯æˆ‘çš„é”™ã€‚", score: { secure: 2, boundary: 2 } }, 
                { text: "ç¬é—´ç´§å¼ ï¼Œä¸‹æ„è¯†åæ€æ˜¯ä¸æ˜¯æˆ‘åšé”™äº†ä»€ä¹ˆï¼Œå¼€å§‹å†…è€—ã€‚", score: { anxiety: 3, sentinel: 3, placate: 2 } }, 
                { text: "æ„Ÿåˆ°åŒçƒ¦æˆ–å‹åŠ›ï¼Œæƒ³è¦èº²å¼€ï¼Œä¸æƒ³è¢«è´Ÿèƒ½é‡ä¼ æŸ“ã€‚", score: { avoid: 2, dismissive: 2 } }, 
                { text: "ç†æ€§åˆ†æä»–ä¸ºä»€ä¹ˆä¸é«˜å…´ï¼Œå¹¶è¯•å›¾å¸®ä»–è§£å†³é—®é¢˜ï¼ˆè€Œéå¤„ç†æƒ…ç»ªï¼‰ã€‚", score: { superReason: 3 } },
                { text: "æˆ‘ä¼šå‡è£…æ²¡çœ‹è§ï¼Œç»§ç»­åšæˆ‘çš„äº‹ï¼Œä½†å¿ƒé‡Œå…¶å®åœ¨æ—¶åˆ»è­¦æƒ•ã€‚", score: { protect: 2, avoid: 1 } }
            ] 
        },
        { 
            id: 15, 
            scene: "æ§åˆ¶ä¸å¤±æ§", 
            text: "å½“ç”Ÿæ´»å‡ºç°çªå‘å˜æ•…ï¼Œäº‹æƒ…å®Œå…¨è„±ç¦»ä½ çš„è®¡åˆ’æ—¶ï¼Ÿ", 
            options: [ 
                { text: "æ¥çº³å˜åŒ–ï¼Œå¯»æ‰¾æ–°çš„è§£å†³åŠæ³•ã€‚", score: { secure: 2 } }, 
                { text: "æåº¦æŠ“ç‹‚ï¼Œå¿…é¡»ç«‹åˆ»æ‰¾äººæŠ±æ€¨æˆ–å€¾è¯‰æ‰èƒ½å¹³å¤ã€‚", score: { anxiety: 3, depend: 1 } }, 
                { text: "æ„¤æ€’ï¼ŒæŒ‡è´£æ˜¯è°å¯¼è‡´äº†è¿™ä¸ªé—®é¢˜ï¼Œå¿…é¡»æœ‰äººè´Ÿè´£ã€‚", score: { blame: 3, control: 2 } }, 
                { text: "æ„Ÿåˆ°æ— åŠ©å’Œç»æœ›ï¼Œè§‰å¾—ä¸€åˆ‡éƒ½å®Œäº†ï¼Œé™·å…¥ç˜«ç—ªçŠ¶æ€ã€‚", score: { trauma: 2, helplessness: 3 } },
                { text: "æƒ…æ„Ÿéš”ç¦»ï¼Œè¿…é€Ÿå¯åŠ¨Bè®¡åˆ’ï¼Œåƒä¸ªæœºå™¨äººä¸€æ ·å¤„ç†å±æœºã€‚", score: { superReason: 3, suppress: 2 } }
            ] 
        },
        { 
            id: 16, 
            scene: "ä»£é™…ææƒ§", 
            text: "å¦‚æœæœªæ¥ä½ æœ‰äº†å­©å­ï¼ˆæˆ–è€…æƒ³è±¡ä½ æœ‰ï¼‰ï¼Œä½ æœ€å®³æ€•è‡ªå·±æˆä¸ºä»€ä¹ˆæ ·çš„çˆ¶æ¯ï¼Ÿ", 
            options: [ 
                { text: "æˆ‘æœ‰ä¿¡å¿ƒèƒ½æ‰“ç ´å¾ªç¯ï¼Œåšä¸€ä¸ªè¶³å¤Ÿå¥½çš„çˆ¶æ¯ã€‚", score: { secure: 2, breakCycle: 3 } }, 
                { text: "å®³æ€•è‡ªå·±åœ¨æƒ…ç»ªå¤±æ§æ—¶ï¼Œéœ²å‡ºå’Œå½“å¹´çˆ¶æ¯ä¸€æ¨¡ä¸€æ ·çš„ç‹°ç‹ç¥æƒ…ã€‚", score: { trauma: 3, reflection: 2 } }, 
                { text: "å®³æ€•è‡ªå·±æ— æ³•ä¸å­©å­äº²è¿‘ï¼Œç”šè‡³å¯¹å­©å­æ„Ÿåˆ°å†·æ¼ å’ŒåŒçƒ¦ã€‚", score: { avoid: 2, numb: 2 } }, 
                { text: "å®³æ€•ç”±äºè¿‡åº¦æººçˆ±/ä¿æŠ¤ï¼Œè®©å­©å­å˜æˆåƒæˆ‘ä¸€æ ·è½¯å¼±çš„äººã€‚", score: { anxiety: 2, control: 1 } },
                { text: "æˆ‘å¯èƒ½ä¼šç”¨ä¸¥æ ¼çš„è§„åˆ™å’Œé€»è¾‘æ¥å…»è‚²ä»–ï¼Œé¿å…è¿‡å¤šæƒ…æ„Ÿçº è‘›ã€‚", score: { superReason: 2, avoid: 1 } }
            ] 
        },
        { 
            id: 17, 
            scene: "è‡ªæˆ‘è¯„ä»·", 
            text: "å¤œæ·±äººé™æ—¶ï¼Œå‰¥ç¦»æ‰å­¦å†ã€å·¥ä½œã€è´¢å¯Œè¿™äº›å¤–åœ¨æ ‡ç­¾ï¼Œä½ è§‰å¾—ä½ æ˜¯è°ï¼Ÿ", 
            options: [ 
                { text: "ä¸€ä¸ªå€¼å¾—è¢«çˆ±ã€æœ¬èº«å°±æœ‰ä»·å€¼çš„äººã€‚", score: { secure: 3, selfEsteem: 2 } }, 
                { text: "ä¸€ä¸ªå¦‚æœä¸åŠªåŠ›ã€ä¸ä¼˜ç§€ï¼Œå°±ä¸€æ— æ˜¯å¤„çš„å†’ç‰Œè´§ã€‚", score: { anxiety: 2, imposter: 3 } }, 
                { text: "ä¸€ä¸ªéº»çƒ¦ï¼Œæ€»æ˜¯åœ¨ç»™åˆ«äººé€ æˆè´Ÿæ‹…ï¼Œæˆ–è€…ä¸è¢«éœ€è¦çš„äººã€‚", score: { shame: 3, lowSelfEsteem: 2 } }, 
                { text: "ä¸€ä¸ªå­¤ç‹¬çš„è§‚å¯Ÿè€…ï¼Œä¸éœ€è¦ä»»ä½•äººä¹Ÿèƒ½è¿‡å¾—å¾ˆå¥½ã€‚", score: { avoid: 2, independent: 2 } },
                { text: "æˆ‘ä¸çŸ¥é“è‡ªå·±æ˜¯è°ï¼Œæ„Ÿè§‰å†…å¿ƒç©ºè¡è¡çš„ã€‚", score: { numb: 3, neglect: 2 } }
            ] 
        },
        { 
            id: 18, 
            scene: "ä¿¡ä»»çš„äº¤ä»˜", 
            text: "æŠŠä½ çš„åèƒŒï¼ˆæœ€è„†å¼±çš„ä¸€é¢ï¼‰å®Œå…¨äº¤ç»™å¦ä¸€ä¸ªäººï¼Œå¯¹ä½ æ¥è¯´ï¼Ÿ", 
            options: [ 
                { text: "æˆ‘æœ‰å‡ ä¸ªç»å¯¹ä¿¡ä»»çš„äººï¼Œå¯ä»¥å®Œå…¨æ”¾æ¾ã€‚", score: { secure: 3 } }, 
                { text: "æˆ‘å¾ˆéš¾å®Œå…¨ä¿¡ä»»ï¼Œæ€»è§‰å¾—åˆ«äººæœ€ç»ˆä¼šè¾œè´Ÿæˆ‘/ç¦»å¼€æˆ‘ã€‚", score: { anxiety: 2, abandonment: 3 } }, 
                { text: "åªè¦ä¸æœŸå¾…ï¼Œå°±ä¸ä¼šå¤±æœ›ï¼Œæ‰€ä»¥æˆ‘ä»ä¸æŠŠå¸Œæœ›å¯„æ‰˜åœ¨äººèº«ä¸Šã€‚", score: { avoid: 3, numb: 1 } }, 
                { text: "æˆ‘ä¼šä¸æ–­æµ‹è¯•å¯¹æ–¹çš„å¿ è¯šåº¦ï¼Œç›´åˆ°å¯¹æ–¹å—ä¸äº†ç¦»å¼€ï¼ˆéªŒè¯äº†æˆ‘çš„é¢„è¨€ï¼‰ã€‚", score: { chaos: 3, fear: 2 } },
                { text: "æˆ‘ç›¸ä¿¡å¥‘çº¦å’Œåˆ©ç›Šäº¤æ¢ï¼Œé‚£æ¯”æ„Ÿæƒ…ç¨³å›ºå¾—å¤šã€‚", score: { superReason: 2, transaction: 2 } }
            ] 
        }
    ];

    // --- ç­”é¢˜å¼•æ“ v2.0 (å¤šé€‰æ”¯æŒç‰ˆ) ---
    let currentQIndex = 0;
    let userScores = { secure: 0, anxiety: 0, avoid: 0, trauma: 0, placate: 0, blame: 0, distract: 0, superReason: 0, intrusion: 0, neglect: 0, shame: 0 };
    let currentSelections = new Set(); // ç”¨äºå­˜å‚¨å½“å‰é¢˜ç›®é€‰ä¸­çš„é€‰é¡¹ç´¢å¼•

    // åˆå§‹åŒ–åŠ è½½
    window.addEventListener('load', () => {
        const savedResult = localStorage.getItem('originsight_result');
        const btn = document.getElementById('nav-btn');
        if (savedResult && btn) {
            btn.innerText = "æŸ¥çœ‹ä¸Šæ¬¡æŠ¥å‘Š";
            btn.onclick = loadSavedReport;
        }
        for(let i=0; i<6; i++) setTimeout(spawnWord, i * 600);
        setInterval(spawnWord, 1000);
    });

    window.toggleAudio = function() { AudioEngine.toggleMute(); }

    // --- è¡¥ä¸Šè¿™ä¸ªç¼ºå¤±çš„å‡½æ•°ï¼Œä¿®å¤æµ®åŠ¨å­—ä½“æ¶ˆå¤±çš„é—®é¢˜ ---
    function loadSavedReport() {
        const savedData = localStorage.getItem('originsight_result');
        if (!savedData) return;

        try {
            const parsed = JSON.parse(savedData);
            userScores = parsed.scores; // æ¢å¤åˆ†æ•°
            generateReport(); // é‡æ–°ç”ŸæˆæŠ¥å‘Š
            
            // è·³è½¬åˆ°æŠ¥å‘Šé¡µ
            document.querySelectorAll('main').forEach(el => el.classList.add('hidden'));
            document.getElementById('page-report').classList.remove('hidden');
            window.scrollTo(0,0);
        } catch (e) {
            console.error("å­˜æ¡£æŸå", e);
            localStorage.removeItem('originsight_result');
            location.reload();
        }
    }

    function startQuiz() {
        switchPage('landing', 'quiz');
        renderQuestion(0);
        if (AudioEngine.isMuted) AudioEngine.toggleMute();
    }

// âœ… ä¿®å¤åçš„æ¸²æŸ“é¢˜ç›®å‡½æ•°
    function renderQuestion(index) {
        const q = questions[index];
        const container = document.getElementById('quiz-container');
        document.getElementById('progress-bar').style.width = `${((index) / questions.length) * 100}%`;
        
        // æ¯ä¸€é¢˜å¼€å§‹å‰ï¼Œæ¸…ç©ºé€‰ä¸­çŠ¶æ€
        currentSelections.clear();

        container.innerHTML = `
            <div class="fade-in-up pb-32">
                <div class="mb-8">
                    <span class="text-xs font-bold text-[#5B7C99] uppercase tracking-widest mb-2 block">SCENE ${index + 1 < 10 ? '0'+(index+1) : index+1}</span>
                    <h2 class="text-2xl md:text-3xl font-bold text-[#2c3e50] leading-snug serif mb-3">${q.text}</h2>
                    <p class="text-sm text-[#5B7C99] bg-blue-50 inline-block px-3 py-1 rounded-full font-medium">âœ¨ å¯å¤šé€‰ï¼Œé€‰å®Œç‚¹å‡»ä¸‹æ–¹ç¡®è®¤</p>
                </div>
                
                <div class="grid gap-4">
                    ${q.options.map((opt, i) => `
                        <div id="opt-${i}" onclick="toggleSelection(${i})" class="spotlight-card group relative bg-white rounded-2xl p-5 md:p-6 border border-gray-100 shadow-sm cursor-pointer transition-all duration-300 transform hover:scale-[1.01] select-none flex items-center gap-4">
                            <div id="checkbox-${i}" class="w-6 h-6 min-w-[24px] rounded-full border-2 border-gray-200 flex items-center justify-center transition-all duration-300">
                                <div class="w-3 h-3 bg-white rounded-full opacity-0 transition-opacity scale-0" style="transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1)"></div>
                            </div>
                            <div class="text-base text-gray-600 font-medium transition duration-300">${opt.text}</div>
                        </div>
                    `).join('')}
                </div>

                <div class="fixed bottom-8 left-0 w-full px-6 flex justify-center z-50 pointer-events-none">
                    <button id="next-btn" onclick="confirmAndNext()" class="pointer-events-auto bg-[#2c3e50] text-white text-lg px-12 py-4 rounded-full font-bold shadow-xl shadow-blue-900/20 hover:bg-[#5B7C99] transition-all duration-500 transform translate-y-24 opacity-0 flex items-center gap-2">
                        <span>ç¡®è®¤é€‰å¥½äº†</span>
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
                    </button>
                </div>
            </div>`;
    }

    // å¤„ç†å¤šé€‰ç‚¹å‡»
    window.toggleSelection = function(i) {
        const card = document.getElementById(`opt-${i}`);
        const checkbox = document.getElementById(`checkbox-${i}`);
        const dot = checkbox.querySelector('div');
        const nextBtn = document.getElementById('next-btn');

        if (currentSelections.has(i)) {
            // å–æ¶ˆé€‰ä¸­
            currentSelections.delete(i);
            // æ ·å¼è¿˜åŸ
            card.classList.remove('border-[#5B7C99]', 'bg-blue-50/40', 'ring-1', 'ring-[#5B7C99]/30');
            card.classList.add('border-gray-100');
            checkbox.classList.remove('bg-[#5B7C99]', 'border-[#5B7C99]');
            checkbox.classList.add('border-gray-200');
            dot.classList.add('opacity-0', 'scale-0');
        } else {
            // é€‰ä¸­
            currentSelections.add(i);
            // æ ·å¼æ¿€æ´»
            card.classList.remove('border-gray-100');
            card.classList.add('border-[#5B7C99]', 'bg-blue-50/40', 'ring-1', 'ring-[#5B7C99]/30');
            checkbox.classList.remove('border-gray-200');
            checkbox.classList.add('bg-[#5B7C99]', 'border-[#5B7C99]');
            dot.classList.remove('opacity-0', 'scale-100');
        }

        // æŒ‰é’®æ˜¾ç¤ºé€»è¾‘ï¼šåªè¦æœ‰é€‰ä¸­é¡¹ï¼Œå°±æ˜¾ç¤ºæŒ‰é’®
        if (currentSelections.size > 0) {
            nextBtn.classList.remove('translate-y-24', 'opacity-0');
        } else {
            nextBtn.classList.add('translate-y-24', 'opacity-0');
        }
    }

    // ç¡®è®¤å¹¶è¿›å…¥ä¸‹ä¸€é¢˜
    window.confirmAndNext = function() {
        if (currentSelections.size === 0) return;

        // è®¡åˆ†é€»è¾‘ï¼šå åŠ æ‰€æœ‰é€‰ä¸­é¡¹çš„åˆ†æ•°
        const q = questions[currentQIndex];
        currentSelections.forEach(optIndex => {
            const scores = q.options[optIndex].score;
            for (let key in scores) {
                userScores[key] = (userScores[key] || 0) + scores[key];
            }
        });

        currentQIndex++;
        if (currentQIndex < questions.length) {
            // ç¨å¾®å»¶è¿Ÿä¸€ä¸‹ï¼Œè®©ç”¨æˆ·çœ‹åˆ°ç‚¹å‡»åé¦ˆ
            setTimeout(() => renderQuestion(currentQIndex), 200);
        } else {
            finishQuiz();
        }
    }

    function finishQuiz() {
        document.getElementById('progress-bar').style.width = '100%';
        switchPage('quiz', 'loading');
        
        // ç¨å¾®è°ƒæ•´ loading æ–‡æ¡ˆï¼Œå¢åŠ ä»ªå¼æ„Ÿ
        const texts = [
            "æ­£åœ¨æ•´åˆå¤æ‚çš„æ½œæ„è¯†æ•°æ®...", 
            "æ£€æµ‹åˆ°å¤šé‡ä¾æ‹æ¨¡å¼...", 
            "æ­£åœ¨å›æº¯ 0-3 å²æƒ…ç»ªå°è®°...", 
            "æ­£åœ¨ç”Ÿæˆæ‚¨çš„ä¸“å±å¿ƒçµç”»åƒ..."
        ];
        const textEl = document.getElementById('loading-text');
        let step = 0; textEl.innerText = texts[0];
        const id = setInterval(() => { step++; if (step < texts.length) textEl.innerText = texts[step]; }, 800);
        setTimeout(() => { clearInterval(id); generateReport(); switchPage('loading', 'report'); }, 3500);
    }

// --- 14. æ ¸å¿ƒæŠ¥å‘Šç”Ÿæˆç³»ç»Ÿ (v17.0 é²œæ´»ç”Ÿå‘½ç‰ˆï¼šè®°å¿†+æ‰“å­—æœº) ---
    function generateReport() {
        let scores = {...userScores};
        let type = "", title = "", desc = "", advice = "", subType = "";
        let shadow = ""; 
        let monologue = ""; 
        let mechanism = ""; 
        let harm = "";      
        let relapse = "";   
        
        let chemistry = { magnet: "", magnetDesc: "", healing: "", healingDesc: "" };
        let manual = { dos: [], donts: [] };
        let sevenDays = [];
        // --- ğŸ†• æ–°å¢ï¼šæ ¹æ®åˆ†æ•°ç”Ÿæˆâ€œæ½œåœ¨äººæ ¼æ ‡ç­¾â€ ---
        let tags = [];
        
        // 1. åŸºç¡€ä¾æ‹æ ‡ç­¾
        if (scores.anxiety > 6) tags.push("ç„¦è™‘å‹ä¾æ‹", "ç²¾ç¥å†…è€—", "é«˜æ•æ„Ÿ");
        if (scores.avoid > 6) tags.push("å›é¿å‹ä¾æ‹", "å‡æ€§äº²å¯†", "é˜²å¾¡æ€§ç‹¬ç«‹");
        if (scores.secure > 8 && scores.anxiety < 4) tags.push("å®‰å…¨å‹ä¾æ‹", "æƒ…ç»ªç¨³å®š");
        
        // 2. ç»†åˆ†ç»´åº¦æ ‡ç­¾ (åŸºäºæ‚¨æä¾›çš„è¯åº“)
        if (scores.placate > 3) tags.push("è®¨å¥½å‹äººæ ¼", "è‡ªæˆ‘ç‰ºç‰²", "å¥½äººåŒ…è¢±");
        if (scores.superReason > 3) tags.push("è¿°æƒ…éšœç¢", "æƒ…æ„Ÿéš”ç¦»", "æ™ºåŠ›å‚²æ…¢");
        if (scores.trauma > 5) tags.push("ä»£é™…åˆ›ä¼¤", "ç¾éš¾åŒ–æ€ç»´", "å¤æ‚æ€§åˆ›ä¼¤(C-PTSD)");
        if (scores.sentinel > 2) tags.push("å…¨å¤©å€™å“¨å…µ", "è¿‡åº¦è­¦è§‰");
        if (scores.spiritualHusband > 2) tags.push("ç²¾ç¥ä¼´ä¾£", "æƒ…ç»ªä¹±ä¼¦");
        
        // 3. ç»„åˆé€»è¾‘
        if (scores.anxiety > 5 && scores.avoid > 5) tags.push("è¾¹ç¼˜å‹äººæ ¼å€¾å‘", "çˆ±æ¨äº¤ç»‡", "æ¨æ‹‰æ¸¸æˆ");
        if (scores.anxiety > 6 && scores.placate > 4) tags.push("å¾®ç¬‘æŠ‘éƒ", "ä¹ å¾—æ€§æ— åŠ©");
        if (scores.avoid > 6 && scores.superReason > 4) tags.push("é˜¿æ–¯ä¼¯æ ¼æ°”è´¨", "æƒ…æ„Ÿæ¼ è§†");
        if (scores.anxiety > 5 && scores.aliveCarrier > 2) tags.push("å…±ç”Ÿç»æ€", "æ€§ä¸Šç˜¾(ä¾æ‹é¥¥æ¸´)");

        // å…œåº•ï¼šå¦‚æœæ ‡ç­¾å¤ªå°‘ï¼Œè¡¥å‡ ä¸ªé€šç”¨çš„
        if (tags.length < 3) tags.push("åŸç”Ÿå®¶åº­", "æ½œæ„è¯†å°è®°");
        
        // ç”Ÿæˆ HTML å­—ç¬¦ä¸²
        const tagsHTML = tags.map(t => 
            `<span class="inline-block bg-white/60 border border-[#5B7C99]/30 text-[#5B7C99] text-xs px-2.5 py-1 rounded-full mb-2 mr-2 shadow-sm font-medium tracking-wide"># ${t}</span>`
        ).join('');

        // --- 1. ç®—æ³•åˆ¤å®š (ä¿æŒ v16 çš„ç²¾å‡†é€»è¾‘) ---
        const maxScore = Math.max(scores.secure, scores.anxiety, scores.avoid, scores.trauma);

// --- 1. å®‰å…¨å‹ä¾æ‹ (The Anchor) â€”â€” å…³é”®è¯ï¼šæƒ…ç»ªå®¹å™¨ã€åœ£æ¯é™·é˜± ---
        if (scores.secure >= scores.anxiety && scores.secure >= scores.avoid && scores.secure >= scores.trauma) {
            
            title = "å®‰å…¨å‹ä¾æ‹ (The Anchor)"; 
            type = "secure";
            
            monologue = "â€œåœ¨è¿™ä¸ªå®¶é‡Œï¼Œçˆ±æ˜¯æµåŠ¨çš„ç©ºæ°”ï¼Œè€Œä¸æ˜¯éœ€è¦äº‰æŠ¢çš„æ°§æ°”ã€‚â€";
            
            // 1. æ·±åº¦ç°çŠ¶ï¼šæƒ…ç»ªå…ç–«ç³»ç»Ÿ
            analysis = `
                ä½ æ‹¥æœ‰ä»¤äººç¾¡æ…•çš„<b>â€œæƒ…ç»ªå…ç–«ç³»ç»Ÿâ€</b>ã€‚
                <br><br>
                åœ¨å…³ç³»ä¸­ï¼Œä½ çš„æä»æ ¸ï¼ˆå¤§è„‘ææƒ§ä¸­å¿ƒï¼‰æ‹¥æœ‰æé«˜çš„é˜ˆå€¼ã€‚é¢å¯¹å†²çªï¼Œä½ ä¸ä¼šåƒç„¦è™‘å‹é‚£æ ·é™·å…¥â€œè¢«æŠ›å¼ƒçš„ææ…Œâ€ï¼Œä¹Ÿä¸ä¼šåƒå›é¿å‹é‚£æ ·å¯åŠ¨â€œæƒ…æ„Ÿéš”ç¦»â€ã€‚ä½ èƒ½ç›´æ¥è°ƒç”¨å‰é¢å¶ï¼ˆç†æ™ºä¸­å¿ƒï¼‰å»è§£å†³é—®é¢˜ã€‚ä½ æ½œæ„è¯†é‡Œçš„æ ¸å¿ƒä¿¡æ¡æ˜¯ï¼š<b>â€œå†²çªæ˜¯æ²Ÿé€šçš„å¥‘æœºï¼Œè€Œä¸æ˜¯å…³ç³»çš„æœ«æ—¥ã€‚â€</b>
            `;
            
            // 2. æ ¹æºå›æº¯ï¼šæ°å¦‚å…¶åˆ†çš„å›åº”
            origin = `
                <b>ğŸ  æ°å¦‚å…¶åˆ†çš„â€œé•œåƒâ€ï¼š</b><br>
                å›æº¯ç«¥å¹´ï¼Œä½ æ‹¿åˆ°çš„æ˜¯äººç”Ÿèµ¢å®¶çš„å‰§æœ¬ã€‚æ ¸å¿ƒæŠšå…»è€…ä¸ä»…æ˜¯ä½ çš„â€œå®‰å…¨åŸºåœ°â€ï¼Œæ›´æ˜¯ä½ çš„<b>â€œæƒ…ç»ªå®¹å™¨â€</b>ã€‚<br>
                <br>
                å½“ä½ è·Œå€’å“­æ³£æ—¶ï¼Œä½ è¢«å…è®¸è¡¨è¾¾è„†å¼±ï¼Œå¹¶å¾—åˆ°äº†åŠæ—¶çš„å®‰æŠšï¼ˆè€Œä¸æ˜¯è¢«å‘ŠçŸ¥â€œä¸è®¸å“­â€ï¼‰ã€‚ä½ çš„éœ€æ±‚è¢«è§†ä¸ºæ­£å½“çš„ï¼Œä½ çš„éšç§è¢«å°Šé‡ã€‚è¿™ç§<b>â€œè¢«çœ‹è§â€</b>å’Œ<b>â€œè¢«å›åº”â€</b>çš„ä½“éªŒï¼Œå†…åŒ–æˆäº†ä½ å¿ƒä¸­ä¸€ä¸ªç¨³å®šçš„å®¢ä½“â€”â€”ä½ ç›¸ä¿¡è‡ªå·±æ˜¯å€¼å¾—è¢«çˆ±çš„ï¼Œä¸–ç•Œæ˜¯åŸºæœ¬å®‰å…¨çš„ã€‚
            `;
            
            // 3. éšæ€§é˜´å½±ï¼šåœ£æ¯é™·é˜±
            shadow = `
                <b>âš ï¸ åœ£æ¯é™·é˜± (The Saint Trap)ï¼š</b><br>
                è™½ç„¶ä½ å¾ˆå¥åº·ï¼Œä½†ä½ æœ€å¤§çš„ç›²ç‚¹æ˜¯<b>â€œå¯¹äººæ€§é˜´æš—é¢ç¼ºä¹æƒ³è±¡åŠ›â€</b>ã€‚<br>
                <br>
                å› ä¸ºä½ å†…å¿ƒå¯Œè¶³ï¼Œä½ å¾ˆå®¹æ˜“å¸å¼•é‚£äº›<b>â€œé»‘æ´å‹äººæ ¼â€</b>ï¼ˆå¦‚è¾¹ç¼˜å‹ã€è‡ªæ‹å‹æˆ–é‡åº¦ç„¦è™‘å‹ï¼‰ã€‚ä½ ä¹ æƒ¯äº†åŒ…å®¹å’Œä¿®è¡¥ï¼Œè§‰å¾—â€œåªè¦æˆ‘å¤šç»™ä¸€ç‚¹çˆ±å°±èƒ½å˜å¥½â€ï¼Œç»“æœå¾€å¾€æ˜¯åœ¨ä¸çŸ¥ä¸è§‰ä¸­è¢«å¯¹æ–¹å½“ä½œâ€œæ— é™èƒ½æºâ€å¸å¹²ï¼Œæ²¦ä¸ºä»–ä»¬æƒ…ç»ªåƒåœ¾çš„æ°¸ä¹…å¡«åŸ‹åœºã€‚
            `;
            
            // 4. æ·±åº¦å¤„æ–¹ï¼šåå‘è¾¹ç•Œ
            prescription = [
                "<b>å»ºç«‹åå‘è¾¹ç•Œï¼š</b>ä½ çš„è¯¾é¢˜ä¸æ˜¯å­¦ä¹ â€œå¦‚ä½•å»çˆ±â€ï¼Œè€Œæ˜¯å­¦ä¹ â€œå¦‚ä½•å†·é…·åœ°æ‹’ç»â€ã€‚",
                "<b>è¯†åˆ«é»‘æ´ï¼š</b>è­¦æƒ•é‚£äº›åˆšè®¤è¯†å°±å¯¹ä½ è¿‡åº¦çƒ­æƒ…ã€æˆ–è€…æ°¸è¿œåœ¨æ‰®æ¼”â€œå—å®³è€…â€çš„æœ‹å‹ã€‚",
                "<b>å»ç¥åœ£åŒ–ï¼š</b>å‘Šè¯‰è‡ªå·±ï¼šæˆ‘åªæ˜¯ä¸€ä¸ªæ™®é€šäººï¼Œä¸æ˜¯æ•‘ä¸–ä¸»ï¼Œä¹Ÿæ²¡æœ‰ä¹‰åŠ¡å»æ²»æ„ˆè°çš„ç«¥å¹´ã€‚"
            ];
            
            // --- å®‰å…¨å‹ä¸“å±é…ç½® ---
            mechanism = "ä½ çš„é˜²å¾¡æœºåˆ¶æ˜¯<b>â€œå¼€æ”¾å¼æ²Ÿé€šâ€</b>ã€‚ä½ ç›¸ä¿¡è„†å¼±èƒ½æ¢æ¥è¿æ¥ï¼Œè€Œä¸æ˜¯æ”»å‡»ã€‚è¿™è®©ä½ åœ¨å…³ç³»ä¸­æ˜¾å¾—ä»å®¹ä¸è¿«ã€‚";
            
            relapse = "<b>åŒæƒ…å¿ƒç–²åŠ³ï¼š</b>å½“ä½ å‘ç°è‡ªå·±å¬å¯¹æ–¹æŠ±æ€¨æ„Ÿåˆ°åŒçƒ¦ã€å´åˆä¸å¥½æ„æ€æ‰“æ–­æ—¶ï¼Œè¯·å¯¹è‡ªå·±è¯´ï¼š<b>â€œæˆ‘ä¸æ˜¯ä»–çš„çˆ¶æ¯ï¼Œæˆ‘ä¹Ÿéœ€è¦è¢«ç…§é¡¾ã€‚â€</b>";

            chemistry.magnet = "ç„¦è™‘å‹æˆ–å›é¿å‹"; 
            chemistry.magnetDesc = "ä½ çš„ç¨³å®šåƒç¯å¡”ä¸€æ ·ï¼Œä¼šæœ¬èƒ½åœ°å¸å¼•é‚£äº›åœ¨æƒ…æ„Ÿé£æš´ä¸­æŒ£æ‰çš„äººã€‚ç„¦è™‘å‹æƒ³æŠ“ä½ä½ è¿™æ ¹æµ®æœ¨ï¼Œå›é¿å‹æƒ³åœ¨ä½ è¿™é‡Œå–æš–ã€‚";
            
            chemistry.healing = "åŒæ ·çš„å®‰å…¨å‹"; 
            chemistry.healingDesc = "ä¸€æ®µä¸éœ€è¦çŒœæµ‹ã€ä¸éœ€è¦å°å¿ƒç¿¼ç¿¼çš„å…³ç³»ã€‚ä½ ä»¬èƒ½äº’ç›¸æ»‹å…»ï¼Œå…±åŒæ¢ç´¢æ›´å¤§çš„ä¸–ç•Œï¼Œè€Œéåœ¨æƒ…ç»ªçš„æ³¥æ½­ä¸­ä¸æ–­æ¶ˆè€—çº ç¼ ã€‚";
            
            manual.dos = ["ç›´æ¥å¦è¯šåœ°æ²Ÿé€šéœ€æ±‚", "å…±åŒè§„åˆ’æœªæ¥", "ç»™äºˆå¹³ç­‰çš„å°Šé‡ä¸ä¿¡ä»»"];
            manual.donts = ["ç©å¼„â€œæ¨æ‹‰â€å¿ƒç†æ¸¸æˆ", "å†·æš´åŠ›æˆ–æ•…æ„æ–­è”", "è¿‡åº¦ç´¢å–æƒ…ç»ªä»·å€¼"];
            
            sevenDays = [
                "åˆ—å‡º 3 ä¸ªä½ æœ€è¿‘å› ä¸ºâ€œåŒ…å®¹åˆ«äººâ€è€Œå¿½ç•¥äº†è‡ªå·±çš„å°éœ€æ±‚ï¼Œå¹¶æ»¡è¶³å®ƒä»¬ã€‚",
                "å¯¹ä¸€ä¸ªä¸åˆç†çš„è¯·æ±‚åšå®šåœ°è¯´â€œä¸â€ï¼Œå¹¶ä¸åŠ ä»»ä½•è§£é‡Šã€‚",
                "ç»™ä¸€ä½å¾ˆä¹…æ²¡è”ç³»çš„è€æœ‹å‹æ‰“ä¸ªç”µè¯ï¼ŒåªèŠå¼€å¿ƒçš„äº‹ã€‚",
                "ç‹¬è‡ªå»ä¸€å®¶æ²¡å»è¿‡çš„å’–å•¡åº—ï¼Œäº«å— 1 å°æ—¶çš„ç‹¬å¤„ã€‚",
                "å†™ä¸‹ 5 ä¸ªä½ æœ€æ¬£èµè‡ªå·±çš„ä¼˜ç‚¹ã€‚",
                "å°è¯•ä¸€é¡¹å…¨æ–°çš„å¾®æŠ€èƒ½ï¼ˆå¦‚åšä¸€é“æ–°èœï¼‰ã€‚",
                "å¯¹ç€é•œå­é‡Œçš„è‡ªå·±è¯´ï¼šè°¢è°¢ä½ ä¸€ç›´ä¿æŠ¤æˆ‘ã€‚"
            ];
        }
// --- 2. æ··ä¹±/ææƒ§å‹ (The Sentinel) â€”â€” å…³é”®è¯ï¼šæƒ…æ„Ÿç»è‚‰æœºã€è®¤æ ½ä¹°å• ---
        else if (
            (scores.trauma >= scores.anxiety && scores.trauma >= scores.avoid) || 
            (scores.anxiety > 8 && scores.avoid > 8 && Math.abs(scores.anxiety - scores.avoid) < 6)
        ) {
            
            title = "æ··ä¹±å‹ä¾æ‹ (The Sentinel)"; 
            type = "fearful";
            
            monologue = "â€œé è¿‘æˆ‘ï¼Œä½†åˆ«ä¼¤å®³æˆ‘â€¦â€¦ç®—äº†ï¼Œä½ è¿˜æ˜¯ç¦»æˆ‘è¿œç‚¹å§ï¼Œå“ªæ€•æˆ‘ä¼šå­¤ç‹¬è‡´æ­»ã€‚â€";
            
            // 1. æ·±åº¦ç°çŠ¶ï¼šå…¨å¤©å€™å“¨å…µ
            analysis = `
                ä½ çš„å†…å¿ƒä½ç€ä¸€ä¸ª<b>â€œå…¨å¤©å€™å“¨å…µâ€</b>ã€‚
                <br><br>
                ä½ æ—¢æåº¦æ¸´æœ›äº²å¯†ï¼Œåˆæœ¬èƒ½åœ°ææƒ§ä¼¤å®³ã€‚è¿™ç§<b>â€œæƒ³é è¿‘å´æƒ³é€ƒç¦»â€</b>çš„æ‚–è®ºï¼Œè®©ä½ åœ¨å…³ç³»ä¸­åå¤æ’•è£‚ã€‚ä½ ä¼šä¸‹æ„è¯†åœ°é€šè¿‡æ¨æ‹‰ã€è¯•æ¢ç”šè‡³åˆ¶é€ æ··ä¹±ï¼ˆDramaï¼‰æ¥æµ‹è¯•å¯¹æ–¹çš„åº•çº¿ã€‚ä½ çš„æ ¸å¿ƒé˜²å¾¡æ˜¯<b>â€œå…ˆå‘åˆ¶äººçš„æŠ›å¼ƒâ€</b>â€”â€”åœ¨å¯¹æ–¹å¯èƒ½ç¦»å¼€æˆ‘ä¹‹å‰ï¼Œæˆ‘å…ˆæç ¸è¿™æ®µå…³ç³»ï¼Œè¿™æ ·æˆ‘å°±ä¸ç”¨é¢å¯¹è¢«æŠ›å¼ƒçš„ææƒ§äº†ã€‚
            `;
            
            // 2. æ ¹æºå›æº¯ï¼šæƒ…æ„Ÿç»è‚‰æœº
            origin = `
                <b>ğŸŒªï¸ é¿é£æ¸¯å³é£æš´æºï¼š</b><br>
                ç«¥å¹´æ—¶ï¼Œä½ çš„å®¶åº­å¯èƒ½æ˜¯ä¸€ä¸ª<b>â€œæƒ…æ„Ÿç»è‚‰æœºâ€</b>ã€‚çˆ¶äº²å¾€å¾€æ˜¯<b>â€œéšå½¢äººâ€</b>ï¼ˆç¼ºå¸­ã€æ²‰é»˜æˆ–é€ƒé¿ï¼‰ï¼Œè€Œæ¯äº²å¯èƒ½æ˜¯<b>â€œæƒ…ç»ªç«å±±â€</b>ï¼ˆå–œæ€’æ— å¸¸ã€è¿‡åº¦å®£æ³„ï¼‰ã€‚<br>
                <br>
                å¯¹å¹¼å¹´çš„ä½ æ¥è¯´ï¼ŒæŠšå…»è€…æ—¢æ˜¯ä½ çš„<b>é¿é£æ¸¯</b>ï¼ˆæœ¬èƒ½æƒ³é è¿‘ï¼‰ï¼Œåˆæ˜¯ä½ çš„<b>ææƒ§æº</b>ï¼ˆæœ¬èƒ½æƒ³é€ƒç¦»ï¼‰ã€‚ä¸ºäº†åœ¨å¤¹ç¼ä¸­ç”Ÿå­˜ï¼Œä½ è¢«è¿«ç»ƒå°±äº†æå¼ºçš„<b>â€œå¾®è¡¨æƒ…æ‰«æèƒ½åŠ›â€</b>ï¼Œæ—¶åˆ»è­¦æƒ•ç€ä¸‹ä¸€åœºé£æš´ï¼Œå¯¼è‡´ä½ çš„ç¥ç»ç³»ç»Ÿæ°¸è¿œå¤„äºæˆ˜å¤‡çŠ¶æ€ã€‚
            `;
            
            // 3. éšæ€§é˜´å½±ï¼šç²¾ç¥æ³•åº­
            shadow = `
                <b>âš–ï¸ ç²¾ç¥æ³•åº­ (The Mental Court)ï¼š</b><br>
                ä½ ä¾ç„¶è¢«å›°åœ¨ç«¥å¹´çš„é‚£ä¸ªæ³•åº­é‡Œï¼Œè¯•å›¾å½“é‚£ä¸ªæ°¸è¿œæ— æ³•èƒœè¯‰çš„è¾©æŠ¤å¾‹å¸ˆã€‚ä½ ç—›è‹¦çš„æ ¹æºï¼Œæ˜¯æ½œæ„è¯†é‡Œè¿˜åœ¨ç­‰çˆ¶æ¯çš„ä¸€ä¸ªé“æ­‰ï¼Œç­‰ä¸€ä¸ª<b>â€œè¿Ÿåˆ°çš„æ­£ä¹‰â€</b>ã€‚<br>
                <br>
                ä½ å¯èƒ½ä¼šåœ¨äº²å¯†å…³ç³»ä¸­ä¸æ–­é‡æ¼”è¿™ç§â€œè¢«è¯¯è§£-ç”³è¯‰-è¢«é©³å›â€çš„å‰§æœ¬ï¼Œè¯•å›¾é€šè¿‡æ”¹é€ ä¼´ä¾£æ¥èµ¢å¾—å½“å¹´çš„é‚£åœºå®˜å¸ã€‚
            `;
            
            // 4. æ·±åº¦å¤„æ–¹ï¼šè®¤æ ½ä¹°å• [å¼•ç”¨ healing_prescription_v1.txt]
            prescription = [
                "<b>è®¤æ ½ä¹°å•ï¼š</b>é†’é†’å§ï¼Œé‚£ä¸ªé“æ­‰æ°¸è¿œä¸ä¼šæ¥ã€‚æ‰¿è®¤ç«¥å¹´å°±æ˜¯â€œæç ¸äº†â€ï¼Œä¸å†å‘ä¼´ä¾£ç´¢è¦ç«¥å¹´çš„æƒ…ç»ªèµ”å¿ã€‚",
                "<b>è¿…é€Ÿç¦»åœºï¼š</b>å½“ä½ ä¸å†æœŸå¾…çˆ¶æ¯æ”¹å˜æ¥æ²»æ„ˆä½ æ—¶ï¼Œä½ æ‰æ‹¿å›äº†å®šä¹‰è‡ªå·±äººç”Ÿçš„ä¸»æƒã€‚",
                "<b>åœæ­¢è‡ªè¯ï¼š</b>ä½ ä¸éœ€è¦é€šè¿‡â€œè™½ç„¶æˆ‘è¢«ä¼¤å®³ï¼Œä½†æˆ‘ä¾ç„¶ä¼˜ç§€â€æ¥è¯æ˜ç»™è°çœ‹ã€‚ä½ çš„å­˜åœ¨æœ¬èº«å°±æ˜¯ä»·å€¼ã€‚"
            ];
            
            // --- æ··ä¹±å‹ä¸“å±é…ç½® ---
            mechanism = "ä½ çš„é˜²å¾¡æœºåˆ¶æ˜¯<b>â€œè§£ç¦»â€ (Dissociation)</b>ã€‚å½“æƒ…ç»ªå‹åŠ›è¿‡å¤§æ—¶ï¼Œä½ ä¼šçªç„¶â€œæ–­ç‰‡â€æˆ–å˜å¾—æåº¦å†·æ¼ ï¼Œä»¿ä½›çµé­‚å‡ºçªï¼Œä»¥æ­¤æ¥åˆ‡æ–­ç—›è‹¦çš„æ„ŸçŸ¥ã€‚";
            
            relapse = "<b>ç‰©ç†æš‚åœï¼š</b>å½“æ„Ÿè§‰æƒ…ç»ªå¤±æ§ã€æƒ³è¯´ç‹ è¯æ¨å¼€å¯¹æ–¹æ—¶ï¼Œå¼ºè¿«è‡ªå·±ç¦»å¼€ç°åœº 15 åˆ†é’Ÿã€‚å‘Šè¯‰å¯¹æ–¹ï¼š<b>â€œæˆ‘ç°åœ¨åˆ›ä¼¤å¤å‘äº†ï¼Œä¸ºäº†ä¸ä¼¤å®³ä½ ï¼Œæˆ‘éœ€è¦ç‹¬å¤„ä¸€ä¼šå„¿ã€‚â€</b>";
            
            chemistry.magnet = "åŒæ ·æ··ä¹±æˆ–æåº¦å†·æ¼ çš„äºº"; 
            chemistry.magnetDesc = "ä½ ä»¬å› ä¸ºâ€œåˆ›ä¼¤çš„ç›¸ä¼¼å‘³é“â€è€Œç›¸äº’å¸å¼•ï¼Œå½¼æ­¤çš„é˜´å½±ç›¸äº’çº ç¼ ã€‚ä½†è¿™ä¼šè®©å…³ç³»å˜æˆéšæ—¶å¯èƒ½çˆ†ç‚¸çš„ç«è¯æ¡¶ï¼Œè®©ä½ åœ¨â€œè¿‡å±±è½¦â€èˆ¬çš„ä½“éªŒä¸­è¯¯ä»¥ä¸ºé‚£æ˜¯çœŸçˆ±ã€‚";
            
            chemistry.healing = "é«˜èƒ½é‡çš„å®‰å…¨å‹"; 
            chemistry.healingDesc = "ä½ éœ€è¦ä¸€ä¸ªæƒ…ç»ªæå…¶ç¨³å®šã€å†…æ ¸å¼ºå¤§çš„äººã€‚ä»–èƒ½çœ‹ç©¿ä½ æ¨å¼€åŠ¨ä½œèƒŒåçš„ææƒ§ï¼Œåšå®šåœ°æ¥ä½ä½ ï¼ŒåŒæ—¶åˆæœ‰æ¸…æ™°çš„åº•çº¿ä¸è¢«ä½ åå™¬ã€‚";
            
            manual.dos = ["ä¿æŒç»å¯¹çš„è¯šå®ä¸é€æ˜", "åœ¨æˆ‘æ¨å¼€ä½ æ—¶åšå®šåœ°ç•™ä¸‹", "æƒ…ç»ªç¨³å®šï¼Œä¸è¢«æˆ‘å¸¦è·‘"];
            manual.donts = ["æ¬ºéª—ï¼ˆå“ªæ€•æ˜¯å–„æ„çš„ï¼‰", "å¿½å†·å¿½çƒ­çš„æ€åº¦", "æŒ‡è´£æˆ‘çš„æƒ…ç»ªåå¤æ— å¸¸"];
            
            sevenDays = [
                "æ·±å‘¼å¸ç»ƒä¹ ï¼šå½“æƒ…ç»ªä¸Šæ¥æ—¶ï¼Œå…ˆæ•° 10 ä¸‹å†è¯´è¯ã€‚",
                "è®°å½•ä¸€ä»¶ä»Šå¤©å‘ç”Ÿçš„ã€ç¡®å®šçš„å¥½äº‹ï¼ˆå“ªæ€•åªæ˜¯å¤©æ°”å¾ˆå¥½ï¼‰ï¼Œé‡å»ºå®‰å…¨æ„Ÿã€‚",
                "å½“ä½ æƒ³æ¨å¼€æŸäººæ—¶ï¼Œè¯•ç€è¯´â€œæˆ‘ç°åœ¨æœ‰ç‚¹å®³æ€•â€è€Œä¸æ˜¯â€œæ»šâ€ã€‚",
                "æ•´ç†æˆ¿é—´çš„ä¸€ä¸ªè§’è½ï¼Œæ„Ÿå—ç§©åºå¸¦æ¥çš„å®‰å®ã€‚",
                "æŠ±ç´§ä¸€ä¸ªæŠ±æ•ï¼Œæƒ³è±¡å®ƒæ˜¯ä¸€ä¸ªå®‰å…¨çš„æ€€æŠ±ï¼Œåœç•™ 5 åˆ†é’Ÿã€‚",
                "æ—©ç¡ 1 å°æ—¶ï¼Œè§„å¾‹çš„ä½œæ¯æ˜¯æƒ…ç»ªç¨³å®šçš„åŸºçŸ³ã€‚",
                "å†™ä¸‹ä¸€å¥å®½æ•è‡ªå·±çš„è¯ï¼šé‚£æ—¶å€™çš„æˆ‘ï¼Œå·²ç»å°½åŠ›äº†ã€‚"
            ];
        }
// --- 3. ç„¦è™‘å‹åˆ¤å®š (Anxious) ---
        else if (scores.anxiety > scores.avoid) {
            type = "anxiety";
            
            // ============================================================
            // åˆ†æ”¯ A: ç„¦è™‘-è®¨å¥½å‹ (The Pleaser) â€”â€” å…³é”®è¯ï¼šç”Ÿå­˜å‡è±¡ã€è¢«é˜‰å‰²çš„æ”»å‡»æ€§
            // ============================================================
            if (scores.placate > scores.anxiety * 0.5) { 
                
                title = "ç„¦è™‘-è®¨å¥½è€… (The Pleaser)"; 
                subType = "è®¨å¥½å‹é˜²å¾¡ / ç”Ÿå­˜å‡è±¡"; 
                
                monologue = "â€œåªè¦æˆ‘è¶³å¤Ÿä¹–ã€è¶³å¤Ÿæœ‰ç”¨ï¼Œä½ ä»¬å°±ä¸ä¼šæŠ›å¼ƒæˆ‘äº†å§ï¼Ÿâ€";
                
                // 1. æ·±åº¦ç°çŠ¶
                analysis = `
                    ä½ çš„æ¸©è‰¯æ­ä¿­è®©ï¼Œå…¶å®æ˜¯ä¸€ç§<b>â€œç”Ÿå­˜å‡è±¡â€ (Survival Illusion)</b>ã€‚
                    <br><br>
                    åœ¨å¤–äººçœ¼é‡Œä½ æ˜¯å®Œç¾çš„â€œå¥½äººâ€ï¼Œä½†åªæœ‰ä½ è‡ªå·±çŸ¥é“ï¼Œè¿™ç§â€œå¥½â€æ˜¯åŸºäºææƒ§è€Œéé€‰æ‹©ã€‚ä½ å¯¹å†²çªæœ‰ç”Ÿç†æ€§çš„åŒæ¶ï¼Œä¸€æ—¦æ„Ÿå—åˆ°æ°”æ°›ä¸å¯¹ï¼Œä½ ä¼šä¸‹æ„è¯†åœ°é€šè¿‡è‡ªæˆ‘ç‰ºç‰²ã€é“æ­‰æˆ–è¿åˆæ¥â€œå¹³äº‹â€ã€‚ä½ æ‰€è°“çš„â€œæ‡‚äº‹â€ï¼Œå…¶å®æ˜¯<b>ç”Ÿå‘½åŠ›è’èŠœ</b>çš„ä»£è¯ã€‚
                `;
                
                // 2. æ ¹æºå›æº¯
                origin = `
                    <b>âš”ï¸ è¢«é˜‰å‰²çš„æ”»å‡»æ€§ï¼š</b><br>
                    å›æº¯ç«¥å¹´ï¼Œä½ å¯èƒ½ç”Ÿæ´»åœ¨ä¸€ä¸ªæåº¦æ‰“å‹â€œä¸ªäººæ„å¿—â€çš„å®¶åº­ã€‚çˆ¶æ¯å¯èƒ½æ˜¯è™šå¼±çš„ã€ææƒ§ç«äº‰çš„ï¼Œä»–ä»¬æœ¬èƒ½åœ°æ‰“å‹ä½ èº«ä¸Šè¡¨ç°å‡ºçš„â€œè‡ªä¿¡ã€å¼ æ‰¬å’Œæ¬²æœ›â€ã€‚<br>
                    <br>
                    ä¸ºäº†ä¸æ¿€æ€’ä»–ä»¬ï¼ˆæˆ–ä¸ºäº†æ´»å‘½ï¼‰ï¼Œä½ å­¦ä¼šäº†<b>â€œè‡ªæˆ‘é˜‰å‰²â€</b>â€”â€”ä½ æŠŠè‡ªå·±çš„æ”»å‡»æ€§ã€é‡å¿ƒå’Œéœ€æ±‚ç»Ÿç»Ÿå…³è¿›äº†åœ°ä¸‹å®¤ï¼Œä»¥æ­¤æ¥æ¢å–åœ¨è¿™ä¸ªå®¶é‡Œçš„ç”Ÿå­˜æƒã€‚
                `;
                
                // 3. éšæ€§é˜´å½±
                shadow = `
                    <b>âš ï¸ éšæ€§æ§åˆ¶ (Covert Control)ï¼š</b><br>
                    ä½ ä¹ æƒ¯â€œä»¥çˆ±ä¹‹åè¡Œæ§åˆ¶ä¹‹å®â€ã€‚ä½ ä»˜å‡ºäº†å¾ˆå¤šï¼Œä½†è¿™èƒŒåå¾€å¾€æ ‡å¥½äº†ä»·æ ¼â€”â€”ä½ æ½œæ„è¯†é‡Œè¦æ±‚å¯¹æ–¹å¿…é¡»å›æŠ¥åŒæ ·çš„å…³æ³¨ã€‚å½“å¯¹æ–¹åšä¸åˆ°æ—¶ï¼Œä½ ä¼šç”¨å†…ç–šæ„Ÿç»‘æ¶å¯¹æ–¹ï¼ˆâ€œæˆ‘ä¸ºä½ ç‰ºç‰²äº†è¿™ä¹ˆå¤šï¼Œä½ æ€ä¹ˆèƒ½è¿™æ ·ï¼Ÿâ€ï¼‰ã€‚è¿™ç§æ²‰é‡çš„æ©æƒ…ï¼Œä¼šè®©çˆ±äººæ„Ÿåˆ°çª’æ¯å¹¶æƒ³è¦é€ƒç¦»ã€‚
                `;
                
                // 4. æ·±åº¦å¤„æ–¹
                prescription = [
                    "<b>å”¤é†’é»‘è‰²ç”Ÿå‘½åŠ›ï¼š</b>æ”»å‡»æ€§ä¸ä»£è¡¨ä¼¤å®³ï¼Œå®ƒæ˜¯ç”Ÿå‘½åŠ›çš„å‘å¤–å»¶ä¼¸ã€‚å…è®¸è‡ªå·±ç”Ÿæ°”ï¼Œå…è®¸è‡ªå·±æƒ³è¦ï¼Œå…è®¸è‡ªå·±èµ¢ã€‚",
                    "<b>é»‘è‰²è§‰é†’ï¼š</b>å½“ä½ å¼€å§‹è¢«é‚£äº›å¹³åº¸çš„äººâ€œå«‰å¦’â€æˆ–â€œæ ‘æ•Œâ€æ—¶ï¼Œæ­å–œä½ ï¼Œä½ çš„ç”Ÿå‘½åŠ›ç»ˆäºé‡æ–°å¼€å§‹è·³åŠ¨äº†ã€‚",
                    "<b>å‰¥ç¦»å†…ç–šæ„Ÿï¼š</b>ä½ è¿‡å¾—å¥½ï¼Œä¸æ˜¯å¯¹å—è‹¦çˆ¶æ¯çš„èƒŒå›ã€‚åœæ­¢ä¸ºäº†è¿™ç§â€œå¿ è¯šâ€è€Œè‡ªæˆ‘æƒ©ç½šã€‚"
                ];

                // 5. æœºåˆ¶ä¸æ€¥æ•‘ (è®¨å¥½å‹ä¸“å±)
                mechanism = "ä½ çš„é˜²å¾¡æœºåˆ¶æ˜¯<b>â€œè¿åˆâ€ (Fawning)</b>ã€‚åœ¨å¨èƒé¢å‰ï¼Œä½ æ—¢ä¸æˆ˜ä¹Ÿä¸é€ƒï¼Œè€Œæ˜¯é€šè¿‡å˜æˆå¯¹æ–¹æƒ³è¦çš„æ ·å­æ¥æ¶ˆé™¤å¨èƒã€‚";
                
                relapse = "<b>æ„¤æ€’ç»ƒä¹ ï¼š</b>å½“ä½ æ„Ÿåˆ°å§”å±ˆæƒ³å“­æ—¶ï¼Œè¯•ç€æŠŠçœ¼æ³ªæ†‹å›å»ï¼Œè½¬æ¢æˆ<b>æ„¤æ€’</b>ã€‚å¯¹ç€ç©ºæˆ¿é—´éª‚ä¸€å¥è„è¯ï¼Œæ„Ÿå—é‚£è‚¡åŠ›é‡ä»ä¸¹ç”°å‡èµ·çš„æ„Ÿè§‰ã€‚";
                
                chemistry.magnet = "è‡ªæ‹å‹æˆ–å›é¿å‹"; 
                chemistry.magnetDesc = "ä½ çš„â€œè¿‡åº¦ä¾›ç»™â€ç®€ç›´æ˜¯è‡ªæ‹è€…çš„å¤©å ‚ï¼Œæˆ–è€…æ˜¯å›é¿è€…çš„èˆ’é€‚åŒºã€‚ä½ è¶Šè®¨å¥½ï¼Œä»–ä»¬è¶Šç†æ‰€å½“ç„¶ï¼Œå½¢æˆå®Œç¾çš„å‰¥å‰Šé—­ç¯ã€‚";
                
                chemistry.healing = "é«˜è‡ªå°Šçš„å®‰å…¨å‹"; 
                chemistry.healingDesc = "ä½ éœ€è¦ä¸€ä¸ªèƒ½æ¬£èµä½ çš„â€œæ”»å‡»æ€§â€è€Œéâ€œé¡ºä»â€çš„äººã€‚å½“ä½ æ‹’ç»ä»–æ—¶ï¼Œä»–ä¸ä»…ä¸ç”Ÿæ°”ï¼Œåè€Œä¼šè¯´ï¼šâ€œå¹²å¾—å¥½ï¼Œä½ æœ‰æ€åº¦äº†ã€‚â€";
                
                manual.dos = ["ä¸»åŠ¨è¯¢é—®æˆ‘çš„çœŸå®æ„Ÿå—ï¼ˆå³ä½¿æˆ‘è¯´æ²¡äº‹ï¼‰", "è‚¯å®šæˆ‘çš„ä»˜å‡ºä¸ä»·å€¼", "é¼“åŠ±æˆ‘æ‹’ç»ä½ "];
                manual.donts = ["æŠŠæˆ‘çš„å¥½å½“æˆç†æ‰€å½“ç„¶", "å¯¹æˆ‘éœ²å‡ºä¸è€çƒ¦çš„ç¥æƒ…", "è®©æˆ‘çŒœä½ çš„å¿ƒæ€"];
                
                sevenDays = [
                    "å¯¹ä¸€ä¸ªä¸åˆç†çš„è¯·æ±‚åšå®šåœ°è¯´â€œä¸â€ï¼Œå¹¶ä¸åŠ ä»»ä½•è§£é‡Šã€‚",
                    "åœ¨ç‚¹é¤æˆ–åšå†³å®šæ—¶ï¼Œä¸é—®â€œä¾¿ä¸ä¾¿å®œ/æ–¹ä¸æ–¹ä¾¿â€ï¼Œåªé—®â€œæˆ‘æƒ³è¦ä»€ä¹ˆâ€ã€‚",
                    "åšä¸€ä»¶è®©è‡ªå·±å¼€å¿ƒã€ä½†å¯èƒ½è®©åˆ«äººè§‰å¾—â€œè‡ªç§â€çš„å°äº‹ã€‚",
                    "è¯•ç€åœ¨å¯¹è¯ä¸­è¡¨è¾¾ä¸€æ¬¡â€œæˆ‘ä¸åŒæ„ä½ çš„è§‚ç‚¹â€ã€‚",
                    "åˆ—å‡º 3 ä¸ªä½ ä¸ºäº†â€œæ‡‚äº‹â€è€Œç‰ºç‰²æ‰çš„æ„¿æœ›ã€‚",
                    "å¯¹ç€é•œå­ç»ƒä¹ çœ¼ç¥çŠ€åˆ©ï¼Œç›´åˆ°è‡ªå·±æ„Ÿåˆ°æœ‰ç‚¹â€œå‡¶â€ã€‚",
                    "å¥–åŠ±è‡ªå·±ä¸€ä»½ä¸éœ€è¦ä»»ä½•äººåŒæ„çš„ç¤¼ç‰©ã€‚"
                ];
            
            // ============================================================
            // åˆ†æ”¯ B: ç„¦è™‘-ç—´è¿·å‹ (The Rescuer) â€”â€” å…³é”®è¯ï¼šç²¾ç¥ä¸ˆå¤«ã€å…±ç”Ÿç»æ€
            // ============================================================
            } else { 
                title = "ç„¦è™‘-ç—´è¿·å‹ (The Rescuer)"; 
                subType = "è¿‡åº¦ä¾èµ– / ç²¾ç¥ä¼´ä¾£"; 
                
                monologue = "â€œæˆ‘è§‰å¾—è‡ªå·±åƒä¸ªåªæœ‰ä¸€åŠçµé­‚çš„äººã€‚æ²¡æœ‰ä½ ï¼Œæˆ‘ä¸çŸ¥é“æˆ‘æ˜¯è°ï¼›ä½†å¤ªé è¿‘ä½ ï¼Œæˆ‘åˆæ€•è‡ªå·±ä¼šæ¶ˆå¤±ã€‚â€";
                
                // 1. æ·±åº¦ç°çŠ¶
                analysis = `
                    ä½ åƒæ˜¯ä¸€æ ªå¿…é¡»ä¾é™„å¤§æ ‘æ‰èƒ½ç”Ÿå­˜çš„è—¤è”“ã€‚åœ¨äº²å¯†å…³ç³»ä¸­ï¼Œä½ æœ€æ ¸å¿ƒçš„ç—›ç‚¹æ˜¯<b>â€œèåˆç„¦è™‘â€</b>ã€‚
                    <br><br>
                    ä½ æŠŠä¼´ä¾£è§†ä¸ºæŠµå¾¡å†…å¿ƒè™šæ— çš„<b>â€œæ´»ä½“è½½ä½“â€</b>ã€‚ä¸€æ—¦å¯¹æ–¹å›å¤æ¶ˆæ¯æ…¢äº†ï¼Œæˆ–è€…è¯­æ°”ç¨å¾®å†·æ·¡ï¼Œä½ å°±ä¼šç¬é—´é™·å…¥ä¸€ç§â€œç”±äºè¢«åˆ‡æ–­è¿æ¥è€Œå¯¼è‡´çš„è‡ªæˆ‘æ¶ˆäº¡æ„Ÿâ€ã€‚ä½ çš„æƒ…ç»ªå¼€å…³å®Œå…¨æŒæ¡åœ¨åˆ«äººæ‰‹é‡Œï¼šä»–é«˜å…´ä½ å°±æ™´å¤©ï¼Œä»–çš±çœ‰ä½ å°±åœ°éœ‡ã€‚è¿™ä¸ä»…æ˜¯çˆ±ï¼Œæ›´æ˜¯ä¸€ç§<b>â€œå…±ç”Ÿç»æ€â€</b>ã€‚
                `;
                
                // 2. æ ¹æºå›æº¯
                origin = `
                    <b>1. é”™ä½çš„â€œç²¾ç¥ä¸ˆå¤«â€ (The Spiritual Husband)ï¼š</b><br>
                    å›æº¯ç«¥å¹´ï¼Œä½ å¯èƒ½ç”Ÿæ´»åœ¨ä¸€ä¸ªçˆ¶äº²æƒ…æ„Ÿç¼ºå¸­ï¼ˆéšå½¢æˆ–æ— èƒ½ï¼‰ã€æ¯äº²å……æ»¡æ€¨æ°”çš„å®¶åº­ã€‚æ¯äº²åœ¨ä¸ˆå¤«é‚£é‡Œå¾—ä¸åˆ°æƒ…æ„Ÿæ”¯æ’‘ï¼Œäºæ˜¯æŠŠç›®å…‰è½¬å‘äº†ä½ ã€‚å¥¹é¢‘ç¹å‘ä½ è¯‰è‹¦ï¼ŒæŠŠä½ å½“æˆäº†å¥¹çš„<b>â€œæƒ…ç»ªåˆä¼™äººâ€</b>ç”šè‡³<b>â€œç²¾ç¥æ”¯æŸ±â€</b>ã€‚<br>
                    <br>
                    <b>2. è¢«è¿«æ—©ç†Ÿçš„â€œå°å¤§äººâ€ï¼š</b><br>
                    ä½ è¢«è¿«æ‰¿æ‹…äº†ä¸å±äºä½ è¿™ä¸ªå¹´çºªçš„æƒ…æ„Ÿé‡é‡ã€‚ä½ ä»å°å°±äº§ç”Ÿäº†ä¸€ç§é”™è§‰å¼çš„ä½¿å‘½æ„Ÿï¼š<b>â€œåªè¦æˆ‘è¶³å¤Ÿä¹–ã€è¶³å¤Ÿä¼˜ç§€ï¼Œå°±èƒ½æ‹¯æ•‘ç—›è‹¦çš„å¦ˆå¦ˆã€‚â€</b> è¿™ç§<b>â€œäº²èŒåŒ–â€ (Parentification)</b> çš„ç»å†ï¼Œè®©ä½ ä¹ æƒ¯äº†é€šè¿‡â€œè¿‡åº¦è´Ÿè´£â€æ¥æ¢å–å­˜åœ¨çš„åˆæ³•æ€§ã€‚
                `;
                
                // 3. éšæ€§é˜´å½±
                shadow = `
                    <b>âš ï¸ æ‹¯æ•‘è€…è¯…å’’ (The Rescuer's Curse)ï¼š</b><br>
                    å› ä¸ºç«¥å¹´æ²¡èƒ½â€œæ•‘å¥½â€æ¯äº²ï¼Œæˆå¹´åä½ ä¼šæ½œæ„è¯†åœ°è¢«é‚£äº›<b>â€œç ´ç¢ã€å¿§éƒã€å›é¿ã€éœ€è¦æ‹¯æ•‘â€</b>çš„äººæ·±æ·±å¸å¼•ã€‚ä½ è¯•å›¾é€šè¿‡ç…§é¡¾ä»–ä»¬ã€ä¿®è¡¥ä»–ä»¬ï¼Œæ¥å®Œæˆç«¥å¹´æœªç«Ÿçš„æ„¿æœ›ã€‚ä½†è¿™å¾€å¾€æ˜¯ä¸€ä¸ªæ— åº•æ´ï¼Œä½ è¶Šä»˜å‡ºï¼Œå¯¹æ–¹è¶Šçª’æ¯ï¼ˆæˆ–è¶Šç´¢å–ï¼‰ï¼Œæœ€åæŠŠä½ æ‹–å®ã€‚<br>
                    <br>
                    <b>âš ï¸ å¿«ä¹ç¾è€»ç—‡ï¼š</b><br>
                    æ¯äº²çš„ç—›è‹¦å†…åŒ–æˆäº†ä½ çš„<b>â€œè´Ÿç½ªæ„Ÿâ€</b>ã€‚ä½ æ½œæ„è¯†é‡Œè§‰å¾—ï¼šâ€œå¦ˆå¦ˆè¿‡å¾—é‚£ä¹ˆè‹¦ï¼Œæˆ‘æ€ä¹ˆæœ‰èµ„æ ¼ç‹¬è‡ªå¿«ä¹ï¼Ÿâ€æ‰€ä»¥ä½ ä¸æ•¢è¿½æ±‚è½»æ¾çš„å¹¸ç¦ï¼Œéè¦æ‰¾ä¸€æ®µè™æ‹æ¥è®©è‡ªå·±â€œå—è‹¦â€ï¼Œæ‰è§‰å¾—å¿ƒå®‰ã€‚
                `;
                
                // 4. æ·±åº¦å¤„æ–¹
                prescription = [
                    "<b>å“¨å…µå½’é˜Ÿï¼š</b>å‘Šè¯‰å†…å¿ƒé‚£ä¸ªå®ˆæœ›äº†åå‡ å¹´çš„å°å“¨å…µï¼šâ€œç°åœ¨çš„ä½ å·²ç»é•¿å¤§äº†ï¼Œä¸éœ€è¦å†é æ—¶åˆ»æ‰«æåˆ«äººçš„è„¸è‰²æ¥æ±‚ç”Ÿäº†ã€‚â€",
                    "<b>å»é“å¾·åŒ–ï¼š</b>è¯·åå¤é»˜å¿µï¼š<b>â€œæ¯äº²çš„å‘½è¿æ˜¯å¥¹è‡ªå·±çš„è¯¾é¢˜ã€‚æˆ‘è¿‡å¾—å¹¸ç¦ï¼Œä¸æ˜¯å¯¹å—è‹¦çˆ¶æ¯çš„èƒŒå›ã€‚â€</b>",
                    "<b>å»ºç«‹é•œåƒï¼š</b>æ¯å¤©è®°å½•ä¸‰ä»¶è‡ªå·±åšå¥½çš„å°äº‹ï¼ˆå¦‚å–äº†ä¸€æ¯å¥½å’–å•¡ï¼‰ï¼Œä¸ä¸ºç»™è°çœ‹ï¼Œåªä¸ºç…§äº®è‡ªå·±ï¼Œå¡«è¡¥é‚£ä¸ªâ€œç©ºå¿ƒâ€çš„è‡ªæˆ‘ã€‚"
                ];

                // 5. æœºåˆ¶ä¸æ€¥æ•‘ (ç—´è¿·å‹ä¸“å±)
                mechanism = "ä½ çš„é˜²å¾¡æœºåˆ¶æ˜¯<b>â€œè¿‡åº¦æ¿€æ´»â€ (Hyperactivation)</b>ã€‚ä½ ä¼šæ”¾å¤§æ‰€æœ‰çš„å±é™©ä¿¡å·ï¼Œé€šè¿‡ä¸æ–­çš„çº ç¼ ã€è®¨å¥½æˆ–æƒ…ç»ªçˆ†å‘ï¼Œå¼ºè¡ŒæŠŠå¯¹æ–¹æ‹‰å›ä½ çš„è§†çº¿èŒƒå›´å†…ã€‚è¿™æœ¬è´¨ä¸Šæ˜¯ä¸€ç§<b>â€œåˆ†ç¦»ç„¦è™‘â€</b>çš„åº”æ¿€ååº”ã€‚";
            
                relapse = "<b>ç‰©ç†åˆ‡æ–­ï¼š</b>å½“ä½ å¿ä¸ä½æƒ³å‘ç¬¬åæ¡å¾®ä¿¡é—®â€œä½ åœ¨å¹²å˜›â€æ—¶ï¼Œç«‹åˆ»<b>å…³æœºæˆ–æŠŠæ‰‹æœºæ‰”åˆ°å¦ä¸€ä¸ªæˆ¿é—´</b>ã€‚å»åšå¹³æ¿æ”¯æ’‘ç›´åˆ°åŠ›ç«­ã€‚å‘Šè¯‰è‡ªå·±ï¼š<b>â€œæˆ‘ç°åœ¨çš„ç„¦è™‘æ˜¯ç«¥å¹´åˆ›ä¼¤çš„é—ªå›ï¼Œæˆ‘ä¸æ˜¯è¢«æŠ›å¼ƒäº†ï¼Œæˆ‘åªæ˜¯åœ¨ç‹¬å¤„ã€‚â€</b>";
                
                chemistry.magnet = "ç–ç¦»-å›é¿å‹ (è‡´å‘½å¸å¼•)"; 
                chemistry.magnetDesc = "è¿™æ˜¯ç»å…¸çš„â€œè¿½é€è€…ä¸é€ƒé¿è€…â€é™·é˜±ã€‚ä»–çš„ç‹¬ç«‹å’Œç¥ç§˜æ„Ÿè®©ä½ ç€è¿·ï¼ˆåƒæäº†é‚£ä¸ªä¸å¯å¾—çš„çˆ¶äº²ï¼‰ï¼Œè€Œä½ çš„ç´§è¿½ä¸èˆè®©ä»–æƒ³é€ƒï¼ˆåƒæäº†ä»–é‚£ä¸ªåå™¬æ€§çš„æ¯äº²ï¼‰ã€‚ä½ ä»¬ç›¸çˆ±ç›¸æ€ï¼Œæ¿€æƒ…ä¸ç—›è‹¦å¹¶å­˜ã€‚";
                
                chemistry.healing = "å®‰å…¨å‹ä¾æ‹ (æƒ…ç»ªå®šæµ·ç¥é’ˆ)"; 
                chemistry.healingDesc = "ä½ éœ€è¦ä¸€ä¸ªäº‹äº‹æœ‰å›åº”ã€æƒ…ç»ªæåº¦ç¨³å®šçš„ä¼´ä¾£ã€‚ä»–èƒ½çœ‹ç©¿ä½ çš„ç„¦è™‘ï¼Œåšå®šåœ°å‘Šè¯‰ä½ â€œæˆ‘åœ¨è¿™é‡Œï¼Œä¸ä¼šèµ°â€ï¼Œå¸¦ä½ èµ°å‡ºæ‚£å¾—æ‚£å¤±çš„å¾ªç¯ã€‚";
                
                manual.dos = ["äº‹äº‹æœ‰å›åº”ï¼Œä»¶ä»¶æœ‰ç€è½", "ä¸»åŠ¨æŠ¥å¤‡è¡Œè¸ªï¼Œç»™æˆ‘å®‰å…¨æ„Ÿ", "å¤šç”¨è‚¢ä½“æ¥è§¦å®‰æŠšæˆ‘"];
                manual.donts = ["ä¸å›æ¶ˆæ¯ç©æ¶ˆå¤±ï¼ˆè¿™æ˜¯æ­»åˆ‘ï¼‰", "è¯´â€œä½ æƒ³å¤šäº†/ä½ å¥½çƒ¦â€", "æ‹’ç»æ²Ÿé€šç›´æ¥å†·æˆ˜"];
                
                sevenDays = [
                    "å¿ä½ä¸å‘é‚£æ¡â€œä½ åœ¨å¹²å˜›â€çš„ä¿¡æ¯ï¼Œæ”¹ä¸ºè‡ªå·±çœ‹ 10 é¡µä¹¦ã€‚", 
                    "ä¸€ä¸ªäººå»æ•£æ­¥ 20 åˆ†é’Ÿï¼Œä¸å¸¦æ‰‹æœºï¼Œæ„Ÿå—é£å¹åœ¨è„¸ä¸Šçš„æ„Ÿè§‰ã€‚", 
                    "åšä¸€ä»¶è®©è‡ªå·±å¼€å¿ƒã€ä½†å¯èƒ½è®©åˆ«äººè§‰å¾—â€œè‡ªç§â€çš„å°äº‹ã€‚", 
                    "å½“æƒ³é“æ­‰æ—¶ï¼Œå…ˆåœä¸‹æ¥é—®è‡ªå·±ï¼šæˆ‘çœŸçš„é”™äº†å—ï¼Ÿ", 
                    "åˆ—å‡º 3 ä¸ªä¸ä¾èµ–ä»»ä½•äººå°±èƒ½è·å¾—çš„å¿«ä¹æºæ³‰ã€‚", 
                    "å¯¹ç€é•œå­è¯´ä¸‰æ¬¡ï¼šåˆ«äººçš„æƒ…ç»ªæ˜¯åˆ«äººçš„è¯¾é¢˜ï¼Œä¸æˆ‘æ— å…³ã€‚", 
                    "å¥–åŠ±è‡ªå·±ä¸€ä»½ä¸éœ€è¦ä»»ä½•äººåŒæ„çš„ç¤¼ç‰©ã€‚"
                ];
            }
        }
// --- 4. å›é¿å‹ (Avoidant) â€”â€” å…³é”®è¯ï¼šæƒ…æ„Ÿéš”ç¦»ã€æ™ºåŠ›å‚²æ…¢ ---
        else { 
            type = "avoid";
            
            // ============================================================
            // åˆ†æ”¯ A: ç–ç¦»-è¶…ç†æ™ºè€… (Rationalizer) â€”â€” å…³é”®è¯ï¼šé€»è¾‘é“ ç”²ã€ç‰©åŒ–ä»–äºº
            // ============================================================
            if (scores.superReason > scores.avoid * 0.5) { 
                
                title = "ç–ç¦»-è¶…ç†æ™ºè€… (Rationalizer)"; 
                subType = "ç†æ™ºé˜²å¾¡ / æ™ºåŠ›å‚²æ…¢"; 
                
                monologue = "â€œæƒ…ç»ªæ˜¯æ— ç”¨çš„å˜é‡ï¼Œåªæœ‰é€»è¾‘æ˜¯æ’å®šçš„çœŸç†ã€‚è¯·ä¸è¦ç”¨ä½ çš„â€˜æ„Ÿè§‰â€™æ¥å¹²æ‰°æˆ‘çš„â€˜åˆ†æâ€™ã€‚â€";
                
                // 1. æ·±åº¦ç°çŠ¶
                analysis = `
                    ä½ åƒæ˜¯ä¸€åº§ç§»åŠ¨çš„å†°å±±ã€‚åœ¨ä½ çš„ä¸–ç•Œé‡Œï¼Œ<b>â€œæ„Ÿå—â€</b>è¢«è§†ä¸ºä¸€ç§ä½æ•ˆç”šè‡³è½¯å¼±çš„è¡¨ç°ã€‚
                    <br><br>
                    ä½ æ“…é•¿å¤„ç†æ•°æ®ã€è§£å†³é—®é¢˜ï¼Œä½†å½“æ¶‰åŠæƒ…æ„Ÿäº¤æµæ—¶ï¼Œä½ ä¼šè‡ªåŠ¨â€œæ–­ç”µâ€æˆ–åˆ‡æ¢åˆ°â€œè¯´æ•™æ¨¡å¼â€ã€‚ä½ å¼•ä»¥ä¸ºå‚²çš„å†·é™ï¼Œå…¶å®æ˜¯ä¸€ç§<b>â€œæƒ…æ„Ÿæ— èƒ½â€</b>ã€‚ä½ ä¹ æƒ¯ç”¨é€»è¾‘æŠŠäºº<b>â€œç‰©åŒ–â€</b>ï¼Œåˆ†æåˆ©å¼Šå¾—å¤±ï¼Œå´å”¯ç‹¬çœ‹ä¸è§æ´»ç”Ÿç”Ÿçš„äººå¿ƒã€‚
                `;
                
                // 2. æ ¹æºå›æº¯
                origin = `
                    <b>ğŸ§  æƒ…ç»ªç¾è€» (Emotional Shame)ï¼š</b><br>
                    åœ¨ä½ çš„åŸç”Ÿå®¶åº­é‡Œï¼Œè¡¨è¾¾æƒ…ç»ªï¼ˆç‰¹åˆ«æ˜¯è„†å¼±ã€ææƒ§æˆ–ä¾èµ–ï¼‰å¾€å¾€æ„å‘³ç€<b>â€œå±é™©â€</b>â€”â€”å¯èƒ½ä¼šæ‹›è‡´çˆ¶æ¯çš„å¿½è§†ã€å˜²ç¬‘ç”šè‡³ç¾è¾±ï¼ˆâ€œå“­æœ‰ä»€ä¹ˆç”¨ï¼Ÿâ€â€œä½ æ€ä¹ˆè¿™ä¹ˆçŸ«æƒ…ï¼Ÿâ€ï¼‰ã€‚<br>
                    <br>
                    ä¸ºäº†ä¿æŠ¤è‡ªå°Šï¼Œä½ è¢«è¿«åˆ‡æ–­äº†ä¸å¿ƒè„çš„è¿æ¥ï¼ŒæŠŠæ‰€æœ‰çš„èƒ½é‡éƒ½æ’¤é€€åˆ°äº†å¤§è„‘é‡Œã€‚ä½ å­¦ä¼šäº†ï¼š<b>â€œåªæœ‰å˜å¾—â€˜æœ‰ç”¨â€™å’Œâ€˜æ­£ç¡®â€™ï¼Œæˆ‘æ‰æ˜¯å®‰å…¨çš„ã€‚â€</b>
                `;
                
                // 3. éšæ€§é˜´å½±
                shadow = `
                    <b>â„ï¸ æ™ºåŠ›å‚²æ…¢ (Intellectual Arrogance)ï¼š</b><br>
                    ä½ ç»å¸¸åœ¨å†…å¿ƒé„™è§†é‚£äº›æƒ…ç»ªå……æ²›çš„äººï¼Œè§‰å¾—ä»–ä»¬â€œå¹¼ç¨šâ€ã€â€œä¸å¯ç†å–»â€ã€‚è¿™ç§å‚²æ…¢æ˜¯ä½ çš„ä¸€å±‚ä¿æŠ¤è‰²ï¼Œç”¨æ¥æ©ç›–ä½ å¯¹<b>â€œå¤±æ§â€</b>çš„æåº¦ææƒ§ã€‚<br>
                    <br>
                    <b>â„ï¸ å†·æš´åŠ›æºå¤´ï¼š</b><br>
                    å½“ä¼´ä¾£è¡¨è¾¾ç—›è‹¦æ—¶ï¼Œä½ å†·é™çš„ç†æ€§åˆ†æå¹¶ä¸æ˜¯åœ¨è§£å†³é—®é¢˜ï¼Œè€Œæ˜¯åœ¨å®æ–½<b>â€œæ‹’ç»è¿æ¥â€</b>çš„å†·æš´åŠ›ã€‚ä½ çš„æ½œå°è¯æ˜¯ï¼šâ€œä½ çš„ç—›è‹¦æ˜¯ä¸åˆé€»è¾‘çš„ï¼Œæ‰€ä»¥æˆ‘ä¸è´Ÿè´£ã€‚â€
                `;
                
                // 4. æ·±åº¦å¤„æ–¹
                prescription = [
                    "<b>å»é€»è¾‘åŒ–ï¼š</b>ä¸‹æ¬¡ä¼´ä¾£éš¾è¿‡æ—¶ï¼Œé—­ä¸Šä½ çš„å˜´ï¼Œæ”¶èµ·ä½ çš„å»ºè®®ã€‚è¯•ç€è¯´ä¸€å¥æ²¡æœ‰é€»è¾‘çš„åºŸè¯ï¼š<b>â€œæˆ‘çœ‹åˆ°ä½ å¾ˆéš¾è¿‡ï¼Œæˆ‘é™ªç€ä½ ã€‚â€</b>",
                    "<b>æ‰¿è®¤è„†å¼±ï¼š</b>æ‰¿è®¤ä½ éœ€è¦è¿æ¥ï¼Œè¿™ä¸ä¸¢äººã€‚çœŸæ­£çš„å¼ºå¤§æ˜¯æ•¢äºå±•ç¤ºè½¯è‚‹ï¼Œè€Œä¸æ˜¯æ—¶åˆ»ç©¿ç€é“ ç”²ã€‚",
                    "<b>åœæ­¢ç‰©åŒ–ï¼š</b>ä¸è¦æŠŠäººå½“æˆä¿®æœºå™¨ã€‚äººæ˜¯éœ€è¦è¢«â€œçœ‹è§â€çš„ï¼Œè€Œä¸æ˜¯è¢«â€œè§£å†³â€çš„ã€‚"
                ];

                mechanism = "ä½ çš„é˜²å¾¡æœºåˆ¶æ˜¯<b>â€œç†æ™ºåŒ–â€ (Intellectualization)</b>ã€‚é€šè¿‡å°†æƒ…æ„Ÿä½“éªŒè½¬åŒ–ä¸ºæŠ½è±¡çš„æ€ç»´æ¦‚å¿µï¼Œæ¥éš”ç¦»ç—›è‹¦çš„æ„Ÿå—ã€‚";

            // ============================================================
            // åˆ†æ”¯ B: ç–ç¦»-ç‹¬è¡Œä¾  (Dismissive) â€”â€” å…³é”®è¯ï¼šå‡æ€§ç‹¬ç«‹ã€æƒ…æ„Ÿè’æ¼ 
            // ============================================================
            } else { 
                title = "ç–ç¦»-ç‹¬è¡Œä¾  (Dismissive)"; 
                subType = "å‡æ€§ç‹¬ç«‹ / æƒ…æ„Ÿè’æ¼ "; 
                
                monologue = "â€œé è°éƒ½ä¸å¦‚é è‡ªå·±ã€‚äººç±»çš„æ‚²æ¬¢å¹¶ä¸ç›¸é€šï¼Œæˆ‘åªè§‰å¾—ä»–ä»¬åµé—¹ã€‚â€";
                
                // 1. æ·±åº¦ç°çŠ¶
                analysis = `
                    ä½ ä»¥â€œä¸éœ€è¦ä»»ä½•äººâ€ä¸ºè£ã€‚ä½ çš„ç‹¬ç«‹ä»¤äººé’¦ä½©ï¼Œä½†é‚£æ˜¯ä¸€æšåˆ»ç€ä¼¤ç—•çš„å‹‹ç« â€”â€”<b>â€œå‡æ€§ç‹¬ç«‹â€ (Pseudo-independence)</b>ã€‚
                    <br><br>
                    ä½ ä¸æ˜¯çœŸçš„ä¸éœ€è¦çˆ±ï¼Œä½ æ˜¯<b>â€œä¸æ•¢â€</b>éœ€è¦ã€‚ä½ é¢„è®¾äº†â€œæ‰€æœ‰äººæœ€ç»ˆéƒ½ä¼šç¦»å¼€â€æˆ–â€œæ²¡æœ‰äººèƒ½çœŸæ­£ç†è§£æˆ‘â€ï¼Œæ‰€ä»¥ä½ é€‰æ‹©å…ˆæ‹’ç»åˆ«äººã€‚ä½ æŠŠè‡ªå·±æ´»æˆäº†ä¸€åº§å­¤å²›ï¼Œè™½ç„¶å®‰å…¨ï¼Œä½†å¯¸è‰ä¸ç”Ÿã€‚
                `;
                
                // 2. æ ¹æºå›æº¯
                origin = `
                    <b>ğŸœï¸ æƒ…æ„Ÿå¿½è§† (Emotional Neglect)ï¼š</b><br>
                    ä½ çš„ç«¥å¹´å¯èƒ½æ²¡æœ‰æ˜æ˜¾çš„è™å¾…ï¼Œä½†å……æ»¡äº†<b>â€œç¼ºå¤±â€</b>ã€‚å½“ä½ ä½œä¸ºå­©å­å‘å‡ºä¿¡å·æ—¶ï¼Œå¾—åˆ°çš„å¾€å¾€æ˜¯â€œå¿™ç¢Œçš„èƒŒå½±â€æˆ–â€œæ¼«é•¿çš„æ²‰é»˜â€ã€‚<br>
                    <br>
                    ä½ æ—©æ—©å­¦ä¼šäº†è‡ªæˆ‘æŠšæ…°ï¼ˆSelf-soothingï¼‰ï¼Œå› ä¸ºæ±‚åŠ©æ˜¯æ— æ•ˆçš„ï¼Œç”šè‡³ç¾è€»çš„ã€‚ä½ çš„æ½œæ„è¯†ä¿¡æ¡æ˜¯ï¼š<b>â€œä¾èµ–å°±æ˜¯è½¯å¼±ï¼ŒæœŸæœ›å°±æ˜¯å¤±æœ›çš„å¼€å§‹ã€‚â€</b>
                `;
                
                // 3. éšæ€§é˜´å½±
                shadow = `
                    <b>ğŸŒµ å‚²æ…¢çš„é˜²å¾¡ï¼š</b><br>
                    ä½ é€šè¿‡è´¬ä½äº²å¯†å…³ç³»çš„ä»·å€¼ï¼ˆâ€œè°ˆæ‹çˆ±ä¸å¦‚æé’±â€ï¼‰æ¥ç»´æŠ¤è‡ªå·±çš„ä¼˜è¶Šæ„Ÿã€‚è¿™å…¶å®æ˜¯ä¸€ç§é…¸è‘¡è„å¿ƒç†â€”â€”å› ä¸ºå¤ªæ€•å¾—ä¸åˆ°ï¼Œæ‰€ä»¥å‡è£…ä¸æƒ³è¦ã€‚<br>
                    <br>
                    <b>ğŸŒµ æƒ…æ„Ÿæ’¤å› (Stonewalling)ï¼š</b><br>
                    ä¸€æ—¦æ„Ÿåˆ°å…³ç³»å¤ªè¿‘ï¼Œä½ ä¼šæœ¬èƒ½åœ°â€œåæ’¤â€æˆ–â€œæŒ‘åˆºâ€ï¼Œç”¨å†·æ¼ æ¥æƒ©ç½šæƒ³è¦é è¿‘ä½ çš„äººã€‚
                `;
                
                // 4. æ·±åº¦å¤„æ–¹
                prescription = [
                    "<b>æ‰¿è®¤äºæŸï¼š</b>æ‰¿è®¤ä½ å†…å¿ƒæ·±å¤„ä¹Ÿæœ‰ä¸€ä¸ªæ¸´æœ›è¢«æŠ±æŠ±çš„å°å­©ã€‚çœ‹è§ç”±äºâ€œè¿‡åº¦ç‹¬ç«‹â€è€Œå¯¼è‡´çš„ç”Ÿå‘½åŠ›æ¯ç«­ã€‚",
                    "<b>å¾®å°ä¾èµ–ï¼š</b>è¯•ç€å‘èº«è¾¹çš„äººè¡¨è¾¾ä¸€ä¸ªå¾®ä¸è¶³é“çš„éœ€æ±‚ï¼ˆæ¯”å¦‚â€œå¸®æˆ‘æ‹¿å¼ çº¸å·¾â€ï¼‰ã€‚ä½ ä¼šå‘ç°ï¼Œå¤©ä¸ä¼šå¡Œä¸‹æ¥ã€‚",
                    "<b>ç•™åœ¨ç°åœºï¼š</b>å½“ä½ æƒ³èº²è¿›æ´ç©´æ—¶ï¼Œå¼ºè¿«è‡ªå·±å†å¤šç•™ 5 åˆ†é’Ÿã€‚"
                ];

                mechanism = "ä½ çš„é˜²å¾¡æœºåˆ¶æ˜¯<b>â€œæƒ…æ„Ÿéš”ç¦»â€ (Isolation of Affect)</b>ã€‚ä¸ºäº†é¿å…å¤±æœ›ï¼Œä½ é¢„å…ˆåˆ‡æ–­äº†æœŸå¾…ï¼ŒæŠŠè‡ªå·±å˜æˆäº†å±€å¤–äººã€‚";
            }
            
            // --- å›é¿å‹é€šç”¨é…ç½® ---
            relapse = "<b>3ç§’æ”¹å£æ³•åˆ™ï¼š</b>å½“ä½ ä¸‹æ„è¯†æƒ³è¯´â€œæˆ‘æ²¡äº‹â€æˆ–è€…æƒ³èº²è¿›æˆ¿é—´æ—¶ï¼Œè¯•ç€åœé¡¿ 3 ç§’ï¼Œæ”¹å£è¯´ï¼š<b>â€œæˆ‘ç°åœ¨æœ‰ç‚¹ç´¯ï¼Œèƒ½ä¸èƒ½é™ªæˆ‘åä¸€ä¼šå„¿ï¼Œä¸ç”¨è¯´è¯ã€‚â€</b> å“ªæ€•åªæ˜¯ç‰©ç†ä¸Šçš„å…±å¤„ï¼Œä¹Ÿæ˜¯æ‰“ç ´éš”ç¦»çš„ä¸€æ­¥ã€‚";
            
            chemistry.magnet = "ç„¦è™‘å‹ä¾æ‹ (è¢«éœ€è¦çš„å¹»è§‰)"; 
            chemistry.magnetDesc = "ä»–ä»¬çš„çƒ­æƒ…è®©ä½ æ„Ÿåˆ°è¢«éœ€è¦ï¼ŒåˆæœŸä½ ä¼šäº«å—è¿™ç§å´‡æ‹œã€‚ä½†éšç€å…³ç³»æ·±å…¥ï¼Œä»–ä»¬å¯¹æƒ…æ„Ÿçš„é«˜æµ“åº¦éœ€æ±‚ä¼šè®©ä½ æ„Ÿåˆ°<b>â€œè¢«åå™¬â€</b>å’Œ<b>â€œå¤±å»è‡ªç”±â€</b>ï¼Œä»è€Œè§¦å‘ä½ çš„é€ƒé¿æœºåˆ¶ã€‚";
            
            chemistry.healing = "å®‰å…¨å‹ä¾æ‹ (æ¸©æŸ”çš„åšæŒ)"; 
            chemistry.healingDesc = "ä½ éœ€è¦ä¸€ä¸ªå°Šé‡ä½ çš„ç‹¬ç«‹ç©ºé—´ã€ä½†ä¸æ”¾å¼ƒä¸ä½ è¿æ¥çš„äººã€‚ä»–ä¸å¼ºè¿«ä½ èåˆï¼Œä½†ä¹Ÿç»ä¸å†·æˆ˜ã€‚ä»–åƒæ¸©æ°´ä¸€æ ·ï¼Œæ…¢æ…¢èåŒ–ä½ çš„å†°å±±ï¼Œè®©ä½ çŸ¥é“<b>â€œç‹¬ç«‹å’Œäº²å¯†å¯ä»¥å…±å­˜â€</b>ã€‚";
            
            manual.dos = ["æœ‰è¯ç›´è¯´ï¼Œè®²é€»è¾‘ï¼Œåˆ«è®©æˆ‘çŒœ", "ç»™æˆ‘ç‹¬å¤„å……ç”µçš„ç©ºé—´ (Cave Time)", "å°±äº‹è®ºäº‹ï¼Œåˆ«æƒ…ç»ªåŒ–å®¡åˆ¤æˆ‘"];
            manual.donts = ["å¼ºè¿«æˆ‘è¡¨è¾¾æ„Ÿå—ï¼ˆé€¼ä¹Ÿæ²¡ç”¨ï¼‰", "ç”¨å“­é—¹æ¥è§£å†³é—®é¢˜", "åœ¨å…¬å…±åœºåˆè®©æˆ‘éš¾å ª"];
            
            sevenDays = [
                "å‘èº«è¾¹çš„äººè¡¨è¾¾ä¸€ä¸ªå¾®å°çš„éœ€æ±‚ï¼ˆå¦‚ï¼šå¸®æˆ‘æ‹¿å¼ çº¸ï¼‰ã€‚",
                "å½“æƒ³èº²è¿›æˆ¿é—´æ—¶ï¼Œå°è¯•åœ¨å®¢å…å¤šåœç•™ 10 åˆ†é’Ÿã€‚",
                "ä¸ç”¨â€œæˆ‘æ²¡äº‹â€æ•·è¡ï¼Œè¯•ç€è¯´â€œæˆ‘ä»Šå¤©æœ‰ç‚¹ç´¯/çƒ¦â€ã€‚",
                "ä¸»åŠ¨ç»™åœ¨ä¹çš„äººå‘ä¸€æ¡åˆ†äº«æ—¥å¸¸çš„æ¶ˆæ¯ï¼ˆä¸å¸¦ç›®çš„ï¼‰ã€‚",
                "çœ‹ç€é•œå­é‡Œçš„è‡ªå·±ï¼Œç»ƒä¹ å¾®ç¬‘ 30 ç§’ï¼Œæ„Ÿå—é¢éƒ¨è‚Œè‚‰ã€‚",
                "æ‰¿è®¤è‡ªå·±ä¹Ÿæœ‰è„†å¼±çš„æ—¶åˆ»ï¼Œå¹¶å†™ä¸‹æ¥ï¼Œä¸ç”¨ç»™ä»»ä½•äººçœ‹ã€‚",
                "å…è®¸æŸäººå¸®è‡ªå·±ä¸€ä¸ªå°å¿™ï¼Œå¹¶çœŸè¯šåœ°è¯´è°¢è°¢ã€‚"
            ];
        }

        // --- ğŸ¨ è§†è§‰å‡çº§ï¼šè‰²æ¸©åˆ‡æ¢ ---
        const rootStyle = document.documentElement.style;
        if (type === 'secure') {
            rootStyle.setProperty('--ocean-top', '#fdfbf7'); rootStyle.setProperty('--ocean-mid', '#e8f5e9'); rootStyle.setProperty('--ocean-bot', '#c8e6c9');
            rootStyle.setProperty('--wave-1', '#81c784'); rootStyle.setProperty('--wave-2', '#a5d6a7'); rootStyle.setProperty('--wave-3', '#c8e6c9');
        } else if (type === 'avoid') {
            rootStyle.setProperty('--ocean-top', '#f0f4f8'); rootStyle.setProperty('--ocean-mid', '#d9e2ec'); rootStyle.setProperty('--ocean-bot', '#bcccdc');
            rootStyle.setProperty('--wave-1', '#627d98'); rootStyle.setProperty('--wave-2', '#829ab1'); rootStyle.setProperty('--wave-3', '#9fb3c8');
        } else if (type === 'anxiety') {
            rootStyle.setProperty('--ocean-top', '#fff5f5'); rootStyle.setProperty('--ocean-mid', '#fed7d7'); rootStyle.setProperty('--ocean-bot', '#feb2b2');
            rootStyle.setProperty('--wave-1', '#e53e3e'); rootStyle.setProperty('--wave-2', '#fc8181'); rootStyle.setProperty('--wave-3', '#fbd38d');
        } else {
            rootStyle.setProperty('--ocean-top', '#E2E8F0'); rootStyle.setProperty('--ocean-mid', '#CBD5E0'); rootStyle.setProperty('--ocean-bot', '#A0AEC0');
            rootStyle.setProperty('--wave-1', '#2D3748'); rootStyle.setProperty('--wave-2', '#4A5568'); rootStyle.setProperty('--wave-3', '#718096');
        }

        // --- åˆ‡æ¢èƒŒæ™¯éŸ³ä¹ ---
        if (!AudioEngine.isMuted) {
            AudioEngine.playAmbience(type);
        }

        // --- è¯„åˆ†æ¡ ---
        const scoreBars = [
            { k: 'anxiety', label: 'ç„¦è™‘', color: 'bg-red-400' },
            { k: 'avoid', label: 'å›é¿', color: 'bg-blue-400' },
            { k: 'secure', label: 'å®‰å…¨', color: 'bg-green-400' },
            { k: 'trauma', label: 'åˆ›ä¼¤', color: 'bg-purple-400' }
        ].map(item => {
            const val = scores[item.k] || 0;
            const percent = Math.min((val / 40) * 100, 100); 
            return `<div class="mb-2 last:mb-0"><div class="flex justify-between text-[10px] text-gray-500 mb-0.5 font-medium"><span>${item.label}</span><span>${val}</span></div><div class="h-1 w-full bg-gray-100 rounded-full overflow-hidden"><div class="h-full ${item.color} opacity-80" style="width: ${percent}%"></div></div></div>`;
        }).join('');

        // --- è¯»å–ä¸ƒæ—¥è®¡åˆ’è¿›åº¦ (Memory) ---
        const savedChecks = JSON.parse(localStorage.getItem('originsight_plan_checks') || '[]');
        
        // --- æ¸²æŸ“é¡µé¢ (UI v17.0) ---
        const container = document.getElementById('report-content');
        const books = type === 'secure' ? ["ã€Šçˆ±çš„è‰ºæœ¯ã€‹", "ã€Šå°‘æœ‰äººèµ°çš„è·¯ã€‹"] : (type === 'anxiety' ? ["ã€Šä¸å†è¯•å›¾å–æ‚¦åˆ«äººã€‹", "ã€Šèµ°å‡ºå¼ºè¿«æ€§é‡å¤ã€‹"] : ["ã€Šå‡æ€§äº²å¯†å…³ç³»ã€‹", "ã€Šè¢«å¿½è§†çš„å­©å­ã€‹"]);
        const movies = type === 'secure' ? ["ã€Šæ™®ç½—æ—ºæ–¯çš„å¤å¤©ã€‹"] : (type === 'anxiety' ? ["ã€Šè¢«å«Œå¼ƒçš„æ¾å­çš„ä¸€ç”Ÿã€‹", "ã€Šé»‘å¤©é¹…ã€‹"] : ["ã€Šå¿ƒçµæ•æ‰‹ã€‹", "ã€Šæµ·è¾¹çš„æ›¼å½»æ–¯ç‰¹ã€‹"]);

// âœ… ä¿®å¤åçš„æŠ¥å‘Šæ¨¡æ¿ï¼šæ­£ç¡®å¼•ç”¨äº† analysis, origin, shadow ç­‰æ–°å˜é‡
        container.innerHTML = `
            <div class="text-center mb-10 fade-in-up">
                <span class="text-xs font-bold text-[#5B7C99] uppercase tracking-widest bg-blue-50 px-3 py-1 rounded-full">CLINICAL REPORT</span>
                <h2 class="text-3xl md:text-5xl font-bold text-[#2c3e50] mt-4 mb-3 serif">æ·±åº¦å¿ƒç†ç—…å†</h2>
                <p class="text-gray-500">ä¾æ‹æ¨¡å¼ï¼š<span class="text-[#2c3e50] font-bold border-b-2 border-[#5B7C99]/30" id="result-type">${title}</span></p>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-12 gap-6 mb-8 fade-in-up delay-100">
                <div class="lg:col-span-4 flex flex-col gap-4 h-full">
                    <div class="bg-white/60 backdrop-blur-md rounded-3xl p-6 shadow-lg shadow-gray-200/50 flex flex-col items-center border border-white/60 flex-1">
                        <div class="relative w-full aspect-square max-w-[260px] mb-4"><canvas id="radar-chart" width="300" height="300"></canvas></div>
                        
                        <div class="w-full mb-4 flex flex-wrap justify-center content-start min-h-[60px]">
                            ${tagsHTML}
                        </div>
                        <div class="w-full bg-white/50 rounded-xl p-5 border border-white/40 mt-auto"><h4 class="text-[10px] font-bold text-gray-400 uppercase tracking-widest mb-3">Dimension Scores</h4>${scoreBars}</div>
                    </div>
                </div>
                <div class="lg:col-span-8 h-full">
                    <div class="bg-white/60 backdrop-blur-md rounded-3xl p-8 md:p-10 shadow-sm border border-white/60 h-full flex flex-col justify-center">
                        <div class="mb-8 relative min-h-[60px]">
                            <span class="absolute -top-6 -left-4 text-7xl text-[#5B7C99] opacity-20 font-serif">â€œ</span>
                            <p id="monologue-text" class="font-serif text-xl md:text-2xl text-[#2c3e50] italic leading-relaxed pl-4 relative z-10 opacity-0"></p>
                        </div>
                        <div class="w-16 h-1 bg-gray-200 rounded-full mb-6"></div>
                        
                        <div class="space-y-8">
                            <div>
                                <h4 class="flex items-center gap-2 font-bold text-[#5B7C99] mb-3 text-sm uppercase tracking-wide"><span class="text-lg">ğŸ›¡ï¸</span> æ·±åº¦å‰–æ (Deep Analysis)</h4>
                                <p class="text-gray-700 leading-relaxed text-justify text-[15px] space-y-2">${analysis || desc}</p> 
                            </div>
                            <div class="bg-gray-50/80 p-6 rounded-2xl border border-gray-100">
                                <h4 class="flex items-center gap-2 font-bold text-[#5B7C99] mb-3 text-sm uppercase tracking-wide"><span class="text-lg">ğŸŒ±</span> æ ¹æºå›æº¯ (Root Cause)</h4>
                                <p class="text-gray-600 leading-relaxed text-justify text-sm">${origin || "æ•°æ®ä¸è¶³ï¼Œæ— æ³•å›æº¯æ ¹æºã€‚"}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 fade-in-up delay-200">
                <div class="bg-red-50/80 backdrop-blur-sm p-6 rounded-3xl border border-red-100 shadow-sm hover:shadow-md transition-all duration-300 hover:-translate-y-1">
                    <div class="flex items-center gap-3 mb-4"><div class="w-10 h-10 bg-red-100 rounded-full flex items-center justify-center text-xl shadow-sm">ğŸŒ‘</div><h4 class="font-bold text-[#c0392b] text-base">éšæ€§é˜´å½±</h4></div>
                    <p class="text-sm text-gray-700 leading-relaxed text-justify">${shadow || "æš‚æ— æ˜¾è‘—é˜´å½±æ•°æ®ã€‚"}</p>
                </div>
                
                <div class="bg-green-50/80 backdrop-blur-sm p-6 rounded-3xl border border-green-100 shadow-sm hover:shadow-md transition-all duration-300 hover:-translate-y-1">
                    <div class="flex items-center gap-3 mb-4"><div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center text-xl shadow-sm">ğŸ’Š</div><h4 class="font-bold text-[#27ae60] text-base">æ ¸å¿ƒå¤„æ–¹</h4></div>
                    <ul class="space-y-3">
                        ${Array.isArray(prescription) ? prescription.map(item => `<li class="text-sm text-gray-700 leading-relaxed flex items-start gap-2"><span class="text-green-500 mt-1">â—</span><span>${item}</span></li>`).join('') : `<li class="text-sm text-gray-700">${advice}</li>`}
                    </ul>
                </div>
                
                <div class="bg-orange-50/80 backdrop-blur-sm p-6 rounded-3xl border border-orange-100 shadow-sm hover:shadow-md transition-all duration-300 hover:-translate-y-1">
                    <div class="flex items-center gap-3 mb-4"><div class="w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center text-xl shadow-sm">ğŸ†˜</div><h4 class="font-bold text-[#d35400] text-base">å¤å‘æ€¥æ•‘åŒ…</h4></div>
                    <p class="text-sm text-gray-700 leading-relaxed text-justify bg-white/60 p-3 rounded-xl border border-orange-200/50 italic">"${relapse}"</p>
                </div>
            </div>

            <div class="bg-gradient-to-br from-pink-50/90 to-purple-50/90 backdrop-blur-md rounded-3xl p-8 mb-8 border border-pink-100 shadow-sm fade-in-up delay-200">
                <h3 class="text-xl font-bold text-[#2c3e50] mb-6 flex items-center gap-3 serif"><span class="text-2xl bg-white p-1 rounded-lg shadow-sm">ğŸ’˜</span> æ‹çˆ±å¥‘åˆåº¦åˆ†æ</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div class="bg-white/50 p-6 rounded-2xl border border-pink-100/50 hover:bg-white/80 transition duration-300">
                        <div class="flex items-center gap-2 mb-3"><span class="text-xl">ğŸ§²</span><h4 class="font-bold text-gray-700">ä½ çš„å¤©ç„¶ç£é“</h4><span class="text-[10px] text-pink-500 bg-pink-100 px-2 py-0.5 rounded-full font-bold ml-auto">è‡´å‘½å¸å¼•</span></div>
                        <h5 class="font-bold text-[#c0392b] text-base mb-2 border-b border-pink-100 pb-2">${chemistry.magnet}</h5><p class="text-sm text-gray-600 leading-relaxed text-justify">${chemistry.magnetDesc}</p>
                    </div>
                    <div class="bg-white/50 p-6 rounded-2xl border border-green-100/50 hover:bg-white/80 transition duration-300">
                        <div class="flex items-center gap-2 mb-3"><span class="text-xl">âœ¨</span><h4 class="font-bold text-gray-700">ä½ çš„ç–—æ„ˆä¼´ä¾£</h4><span class="text-[10px] text-green-600 bg-green-100 px-2 py-0.5 rounded-full font-bold ml-auto">ç†æƒ³å‹</span></div>
                        <h5 class="font-bold text-[#27ae60] text-base mb-2 border-b border-green-100 pb-2">${chemistry.healing}</h5><p class="text-sm text-gray-600 leading-relaxed text-justify">${chemistry.healingDesc}</p>
                    </div>
                </div>
            </div>

            <div class="bg-white/60 backdrop-blur-md rounded-3xl p-8 mb-8 border border-white/60 shadow-sm fade-in-up delay-200">
                <h3 class="text-xl font-bold text-[#2c3e50] mb-6 flex items-center gap-3 serif"><span class="text-2xl bg-[#2c3e50] text-white p-1 rounded-lg shadow-sm text-sm flex items-center justify-center w-8 h-8">ğŸ“</span> æˆ‘çš„ä½¿ç”¨è¯´æ˜ä¹¦</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <div><h4 class="font-bold text-[#27ae60] mb-4 flex items-center gap-2"><span class="bg-green-100 p-1 rounded text-xs">âœ…</span> æ­£ç¡®æ“ä½œ (Do's)</h4><ul class="space-y-3">${manual.dos.map(item => `<li class="flex items-start gap-3 bg-green-50/50 p-3 rounded-xl text-sm text-gray-700 border border-green-100"><span class="text-green-500 font-bold">âœ“</span>${item}</li>`).join('')}</ul></div>
                    <div><h4 class="font-bold text-[#c0392b] mb-4 flex items-center gap-2"><span class="bg-red-100 p-1 rounded text-xs">ğŸš«</span> ç¦å¿Œäº‹é¡¹ (Don'ts)</h4><ul class="space-y-3">${manual.donts.map(item => `<li class="flex items-start gap-3 bg-red-50/50 p-3 rounded-xl text-sm text-gray-700 border border-red-100"><span class="text-red-500 font-bold">âœ•</span>${item}</li>`).join('')}</ul></div>
                </div>
            </div>

            <div class="bg-gradient-to-r from-teal-50/90 to-cyan-50/90 backdrop-blur-md rounded-3xl p-8 mb-8 border border-teal-100 shadow-sm fade-in-up delay-200 relative overflow-hidden">
                <div class="absolute top-0 right-0 w-32 h-32 bg-teal-100/50 rounded-full blur-3xl -mr-10 -mt-10 pointer-events-none"></div>
                <div class="flex justify-between items-center mb-6 relative z-10">
                    <div>
                        <h3 class="text-xl font-bold text-[#2c3e50] mb-2 flex items-center gap-3 serif"><span class="text-2xl bg-white p-1 rounded-lg shadow-sm">ğŸ“…</span> ä¸ƒæ—¥å¾®ç–—æ„ˆè®¡åˆ’</h3>
                        <p class="text-sm text-gray-500">æ¯å¤© 5 åˆ†é’Ÿï¼Œé‡å¡‘ä½ çš„ä¾æ‹ç¥ç»å›è·¯ã€‚</p>
                    </div>
                    <div class="text-right">
                        <div id="plan-progress-text" class="text-2xl font-bold text-teal-600">${savedChecks.length} / 7</div>
                        <div class="text-xs text-teal-500 uppercase tracking-widest">Completed</div>
                    </div>
                </div>
                
                <div class="space-y-3 relative z-10">
                    ${sevenDays.map((task, i) => {
                        const isChecked = savedChecks.includes(i);
                        return `
                        <div class="flex items-center gap-4 p-4 rounded-xl border transition-all cursor-pointer group ${isChecked ? 'bg-teal-50 border-teal-200' : 'bg-white/60 border-teal-100 hover:bg-white/90'}" onclick="toggleDailyTask(this, ${i})">
                            <div class="w-6 h-6 rounded-full border-2 border-teal-300 flex items-center justify-center transition-colors group-hover:border-teal-500">
                                <div class="w-3 h-3 bg-teal-500 rounded-full transition-opacity ${isChecked ? '' : 'opacity-0'}"></div>
                            </div>
                            <span class="text-sm transition-colors ${isChecked ? 'text-teal-400 line-through' : 'text-gray-700 group-hover:text-teal-800'}">Day ${i+1}: ${task}</span>
                        </div>
                        `;
                    }).join('')}
                </div>
            </div>

            <div class="bg-white/40 backdrop-blur-sm rounded-3xl p-8 mb-12 border border-white/40 fade-in-up delay-300">
                <h3 class="text-xl font-bold mb-6 text-[#2c3e50] serif flex items-center gap-2"><span class="w-1.5 h-6 bg-[#5B7C99] rounded-full"></span> ç»™ä½ çš„ç–—æ„ˆå»ºè®®</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-white/60 backdrop-blur-md p-6 rounded-2xl shadow-sm border border-white/50 hover:-translate-y-1 transition-transform duration-300"><div class="text-2xl mb-3">ğŸ“–</div><h4 class="font-bold text-sm mb-2 text-[#2c3e50]">æ¨èä¹¦å•</h4><ul class="text-xs text-gray-500 space-y-2">${books.map(b => `<li>â€¢ ${b}</li>`).join('')}</ul></div>
                    <div class="bg-white/60 backdrop-blur-md p-6 rounded-2xl shadow-sm border border-white/50 hover:-translate-y-1 transition-transform duration-300"><div class="text-2xl mb-3">ğŸ¬</div><h4 class="font-bold text-sm mb-2 text-[#2c3e50]">å½±è§†ç–—æ„ˆ</h4><ul class="text-xs text-gray-500 space-y-2">${movies.map(m => `<li>â€¢ ${m}</li>`).join('')}</ul></div>
                </div>
            </div>

            <div id="bottle-section" class="max-w-xl mx-auto mb-16 text-center relative z-20 fade-in-up delay-300">
                <div class="w-16 h-1 bg-gray-200 rounded-full mx-auto mb-8"></div>
                <h3 class="text-xl font-bold text-[#5B7C99] mb-4 serif">ğŸŒŠ æ·±æµ·å¯„ä¿¡</h3>
                <p class="text-sm text-gray-500 mb-6 leading-relaxed">æœ‰äº›è¯è—åœ¨å¿ƒé‡Œå¤ªä¹…äº†ã€‚<br>å¦‚æœæœ‰æœºä¼šç©¿è¶Šæ—¶ç©ºï¼Œä½ æƒ³å¯¹é‚£ä¸ªå—ä¼¤çš„å°æ—¶å€™çš„è‡ªå·±ï¼Œè¯´ä¸€å¥ä»€ä¹ˆï¼Ÿ</p>
                <div class="relative group max-w-lg mx-auto">
                    <textarea id="bottle-message" rows="3" placeholder="â€œå˜¿ï¼Œåˆ«æ€•ï¼Œä½ é•¿å¤§äº†ä¼šå¾ˆæ£’çš„...â€" class="w-full bg-white/40 backdrop-blur-sm rounded-2xl p-4 border border-white/60 text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-[#5B7C99]/30 focus:bg-white/60 transition resize-none shadow-inner"></textarea>
                    <button onclick="throwBottle()" class="absolute bottom-3 right-3 bg-[#5B7C99] text-white p-2 rounded-full shadow-lg hover:bg-[#4a6b8a] transition-transform hover:scale-110 active:scale-95 flex items-center gap-1 pr-3 pl-2"><span class="text-lg">ğŸŒŠ</span> <span class="text-xs font-bold">æŠ•é€’</span></button>
                </div>
                <div id="bottle-feedback" class="hidden mt-6 text-[#5B7C99] text-sm animate-pulse font-serif">å·²æŠ•é€’ã€‚æµ·æµªä¼šå¸¦èµ°è¿™ä»½å¿ƒæ„ï¼Œæ„¿ä½ ä»Šå¤œå¥½æ¢¦ã€‚âœ¨</div>
            </div>

            <div class="flex flex-col items-center gap-6 pb-20 fade-in-up delay-300">
                <div class="flex gap-4">
                    <button onclick="generateImage()" class="group relative bg-[#2c3e50] text-white px-8 py-3.5 rounded-full font-bold shadow-xl hover:bg-[#5B7C99] transition-all duration-300 transform hover:-translate-y-1 active:scale-95 flex items-center gap-2"><span class="text-lg">ğŸ“¸</span><span>ç”Ÿæˆå¿ƒçµç”»åƒå¡ç‰‡</span></button>
                    <button onclick="location.reload()" class="px-6 py-3.5 rounded-full border border-gray-300 text-gray-500 hover:border-[#5B7C99] hover:text-[#5B7C99] transition font-medium text-sm">é‡æ–°æµ‹è¯•</button>
                </div>
            </div>
            
            <div id="share-poster" class="fixed top-[-9999px] left-[-9999px] w-[375px] bg-[#F9F8F6] p-8 rounded-none text-center pointer-events-none">
                <div class="mb-6 flex justify-center"><img src="./images/logo-silhouette.png" class="w-12 h-12 rounded-full border-2 border-[#2c3e50]/10"></div>
                <div class="text-xs tracking-[0.3em] text-gray-400 uppercase mb-2">OriginSight Profile</div>
                <h2 class="text-2xl font-bold text-[#2c3e50] mb-2 serif">${title}</h2>
                <p class="text-xs text-[#5B7C99] mb-6 font-mono">${new Date().toLocaleDateString()}</p>
                <div class="w-full aspect-square bg-white/50 rounded-full flex items-center justify-center mb-6 relative overflow-hidden"><img id="poster-radar-img" class="w-full h-full object-contain p-4" /></div>
                <div class="text-left bg-white p-5 rounded-xl shadow-sm mb-6 border border-gray-100"><p class="text-sm text-gray-600 leading-relaxed font-serif italic">â€œ${monologue.replace(/â€œ|â€/g, '')}â€</p></div>
                <div class="text-left mb-6"><h4 class="font-bold text-[#2c3e50] text-xs mb-2">ğŸ“ å¦‚ä½•çˆ±æˆ‘ (User Manual)</h4><div class="bg-white p-4 rounded-xl border border-gray-100 text-xs text-gray-600 space-y-1"><p>âœ… ${manual.dos[0]}</p><p>âœ… ${manual.dos[1]}</p><p>ğŸš« ${manual.donts[0]}</p></div></div>
                <div class="grid grid-cols-2 gap-3 mb-8"><div class="bg-blue-50 p-3 rounded-lg text-left"><span class="text-[10px] text-gray-400 block">ç„¦è™‘æŒ‡æ•°</span><span class="font-bold text-[#2c3e50]">${scores.anxiety}</span></div><div class="bg-blue-50 p-3 rounded-lg text-left"><span class="text-[10px] text-gray-400 block">å›é¿æŒ‡æ•°</span><span class="font-bold text-[#2c3e50]">${scores.avoid}</span></div></div>
                <div class="flex items-center justify-center gap-2 opacity-60 mt-4"><span class="text-xs font-bold text-[#2c3e50]">OriginSight.com</span></div>
            </div>
        `;


        // è§¦å‘é›·è¾¾å›¾ + æ‰“å­—æœºç‰¹æ•ˆ
        setTimeout(() => {
            const maxVal = Math.max(scores.anxiety, scores.avoid, scores.secure, scores.trauma, scores.placate, 8);
            const data = [(scores.anxiety||0)/maxVal, (scores.avoid||0)/maxVal, (scores.placate||0)/maxVal, (scores.trauma||0)/maxVal, (scores.secure||0)/maxVal];
            drawRadarChart(data);
            
            // è§¦å‘æ‰“å­—æœº
            typeWriter('monologue-text', monologue, 60);

            setTimeout(() => {
                const canvas = document.getElementById('radar-chart');
                if(canvas) {
                    const imgData = canvas.toDataURL("image/png");
                    const posterImg = document.getElementById('poster-radar-img');
                    if(posterImg) posterImg.src = imgData;
                }
            }, 200);
        }, 500); 

        localStorage.setItem('originsight_result', JSON.stringify({title, type, scores}));
    }

    function switchPage(from, to) {
        const fromEl = document.getElementById(`page-${from}`);
        const toEl = document.getElementById(`page-${to}`);
        fromEl.classList.add('page-exit');
        setTimeout(() => {
            fromEl.classList.add('hidden'); fromEl.classList.remove('page-exit');
            toEl.classList.remove('hidden'); toEl.classList.add('page-enter'); window.scrollTo(0,0);
        }, 400);
    }

    function copyShareResult() {
        const title = document.getElementById('result-type').innerText;
        const text = `æˆ‘åœ¨ã€OriginSightã€‘çš„åŸç”Ÿå®¶åº­æ·±åº¦å›æº¯ä¸­æµ‹å‡ºæˆ‘æ˜¯ï¼š ğŸ‘‰ ã€Œ${title}ã€ ğŸŒŸ çœ‹è§æ˜¯æ”¹å˜çš„å¼€å§‹ï¼Œä½ ä¹Ÿæ¥æ¢ç´¢ä¸€ä¸‹å§ï¼š ${window.location.href}`;
        navigator.clipboard.writeText(text).then(() => {
            const t = document.getElementById('copy-toast');
            t.classList.remove('opacity-0'); t.classList.add('opacity-100', 'translate-y-[-5px]');
            setTimeout(() => { t.classList.remove('opacity-100', 'translate-y-[-5px]'); t.classList.add('opacity-0'); }, 2000);
        }).catch(() => alert("å¤åˆ¶å¤±è´¥ï¼Œè¯·æˆªå›¾åˆ†äº«"));
    }

    function drawRadarChart(data) {
        const canvas = document.getElementById('radar-chart');
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        const dpr = window.devicePixelRatio || 1;
        const rect = canvas.getBoundingClientRect();
        if(rect.width === 0) return;
        canvas.width = rect.width * dpr; canvas.height = rect.height * dpr;
        ctx.scale(dpr, dpr);
        const w = rect.width, h = rect.height, cx = w/2, cy = h/2, radius = w/2 - 30;
        const sides = 5, labels = ['ç„¦è™‘', 'å›é¿', 'è®¨å¥½', 'åˆ›ä¼¤', 'å®‰å…¨'];
        
        ctx.clearRect(0,0,w,h);
        ctx.strokeStyle = 'rgba(200, 200, 200, 0.4)'; ctx.lineWidth = 1;
        for (let r=0.2; r<=1; r+=0.2) { ctx.beginPath(); for(let i=0; i<sides; i++) { const a = (Math.PI*2*i)/sides - Math.PI/2; ctx[i===0?'moveTo':'lineTo'](cx + Math.cos(a)*radius*r, cy + Math.sin(a)*radius*r); } ctx.closePath(); ctx.stroke(); }
        
        ctx.beginPath(); for(let i=0; i<sides; i++) { const a = (Math.PI*2*i)/sides - Math.PI/2; ctx.moveTo(cx,cy); ctx.lineTo(cx + Math.cos(a)*radius, cy + Math.sin(a)*radius); } ctx.stroke();

        ctx.beginPath();
        const points = [];
        data.forEach((val, i) => { const v = Math.max(val, 0.1); const a = (Math.PI*2*i)/sides - Math.PI/2; const x = cx+Math.cos(a)*radius*v, y = cy+Math.sin(a)*radius*v; points.push({x,y}); ctx[i===0?'moveTo':'lineTo'](x,y); });
        ctx.closePath();
        const grad = ctx.createRadialGradient(cx,cy,0,cx,cy,radius); grad.addColorStop(0,'rgba(91, 124, 153, 0.6)'); grad.addColorStop(1,'rgba(91, 124, 153, 0.1)');
        ctx.fillStyle = grad; ctx.fill(); ctx.strokeStyle = '#5B7C99'; ctx.lineWidth = 2; ctx.stroke();

        ctx.fillStyle = '#fff'; points.forEach(p => { ctx.beginPath(); ctx.arc(p.x,p.y,3,0,Math.PI*2); ctx.fill(); ctx.stroke(); });
        ctx.fillStyle = '#64748b'; ctx.font = 'bold 12px Noto Serif SC'; ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
        labels.forEach((l, i) => { const a = (Math.PI*2*i)/sides - Math.PI/2; ctx.fillText(l, cx+Math.cos(a)*(radius+20), cy+Math.sin(a)*(radius+20)); });
    }

    const wordList = ["å›é¿å‹ä¾æ‹", "ç„¦è™‘å‹ä¾æ‹", "æŠ‘éƒç—‡", "æ‹–å»¶ç—‡", "é«˜æ•æ„Ÿ", "ç²¾ç¥å†…è€—", "æƒ…æ„Ÿæ¼ è§†", "æ€§ä¸Šç˜¾", "ç”Ÿç†æ€§åŒæ¶", "é˜¿æ–¯ä¼¯æ ¼", "è®¨å¥½å‹äººæ ¼", "ä¹ å¾—æ€§æ— åŠ©", "å†’å……è€…ç»¼åˆå¾", "è¿°æƒ…éšœç¢", "å‡æ€§äº²å¯†", "å…±ç”Ÿç»æ€", "ç©ºå¿ƒç—…", "å¾®ç¬‘æŠ‘éƒ", "å¼ºè¿«ç—‡", "è¾¹ç¼˜å‹äººæ ¼", "ç…¤æ°”ç¯æ•ˆåº”", "æš´é£Ÿç—‡", "è¢«åŠ¨æ”»å‡»", "å®Œç¾ä¸»ä¹‰", "ç¾éš¾åŒ–æ€ç»´", "äº²èŒåŒ–", "æƒ…æ„Ÿå‹’ç´¢", "è‡ªæ‹é˜²å¾¡", "é•¿ä¸å¤§çš„çˆ¶æ¯", "ä»£é™…åˆ›ä¼¤"];
    function spawnWord() {
        const container = document.getElementById('ocean-container');
        if (!container) return;
        const el = document.createElement('div'); el.className = 'ocean-word';
        el.innerText = wordList[Math.floor(Math.random() * wordList.length)];
        const layer = Math.floor(Math.random()*3)+1;
        const size = layer===3 ? 18 : (layer===2 ? 24 : 32);
        el.style.fontSize = `${size + Math.random()*8}px`;
        el.style.color = layer===3 ? 'rgba(164,184,196,0.9)' : (layer===2 ? 'rgba(91,124,153,0.95)' : '#2c3e50');
        el.style.zIndex = layer===3 ? 5 : (layer===2 ? 15 : 25);
        if(layer===3) el.style.filter = 'blur(1.5px)';
        if(layer===1) { el.style.fontWeight = '700'; el.style.textShadow = '0 4px 10px rgba(255,255,255,0.5)'; }
        el.style.left = `${Math.floor(Math.random()*90)+5}%`;
        el.style.bottom = `${15 + Math.random()*15}%`;
        el.style.animation = `floatAndSink ${8+Math.random()*6}s ease-in-out forwards`;
        container.appendChild(el);
        setTimeout(() => el.remove(), 14000);
    }
    // å…‰æ•ˆæ§åˆ¶
    window.handleSpotlight = function(e, card) {
        const rect = card.getBoundingClientRect();
        card.style.setProperty('--mouse-x', `${e.clientX - rect.left}px`);
        card.style.setProperty('--mouse-y', `${e.clientY - rect.top}px`);
    }

    // --- é¡µé¢å¯¼èˆªè¾…åŠ©å‡½æ•° ---
    // æ‰“å¼€æŸä¸ªé¡µé¢ï¼ˆè¦†ç›–å½“å‰å†…å®¹ï¼‰
    function openPage(pageId) {
        // éšè—æ‰€æœ‰ main æ ‡ç­¾
        document.querySelectorAll('main').forEach(el => {
            if(!el.classList.contains('hidden')) {
                el.dataset.active = 'true'; // æ ‡è®°ä¸€ä¸‹å½“å‰æ­£åœ¨æ˜¾ç¤ºçš„é¡µé¢ï¼Œä»¥ä¾¿è¿”å›
                el.classList.add('hidden');
            }
        });
        
        // æ˜¾ç¤ºç›®æ ‡é¡µé¢
        const target = document.getElementById(pageId);
        target.classList.remove('hidden');
        target.classList.add('fade-in-up');
        window.scrollTo(0,0);
    }

    // å…³é—­è¦†ç›–é¡µï¼Œè¿”å›ä¹‹å‰çš„é¡µé¢
    function closeOverlay(pageId) {
        document.getElementById(pageId).classList.add('hidden');
        
        // å°è¯•æ‰¾å›åˆšæ‰æ ‡è®°ä¸º active çš„é¡µé¢ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±å›é¦–é¡µ
        let prevPage = document.querySelector('main[data-active="true"]');
        if (!prevPage) prevPage = document.getElementById('page-landing');
        
        prevPage.classList.remove('hidden');
        delete prevPage.dataset.active;
    }

// --- æ–°å¢ï¼šç”Ÿæˆåˆ†äº«å›¾ç‰‡ ---
    function generateImage() {
        const posterEl = document.getElementById('share-poster');
        const modal = document.getElementById('image-modal');
        const container = document.getElementById('generated-image-container');
        
        if (!posterEl) return;

        // æ˜¾ç¤ºåŠ è½½æç¤º
        const btn = document.querySelector('button[onclick="generateImage()"] span:last-child');
        const originalText = btn.innerText;
        btn.innerText = "ç”Ÿæˆä¸­...";

        html2canvas(posterEl, {
            scale: 2, // 2å€æ¸…æ™°åº¦
            backgroundColor: '#F9F8F6', // ç¡®ä¿èƒŒæ™¯è‰²æ­£ç¡®
            useCORS: true
        }).then(canvas => {
            // æ¸…ç©ºå®¹å™¨
            container.innerHTML = '';
            // æŠŠ canvas è½¬ä¸º img
            const img = new Image();
            img.src = canvas.toDataURL("image/png");
            img.className = "w-full h-auto";
            container.appendChild(img);
            
            // æ˜¾ç¤ºå¼¹çª—
            modal.classList.remove('hidden');
            
            // æ¢å¤æŒ‰é’®æ–‡å­—
            btn.innerText = originalText;
        }).catch(err => {
            console.error(err);
            alert("ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•");
            btn.innerText = originalText;
        });
    }

    function closeImageModal() {
        document.getElementById('image-modal').classList.add('hidden');
    }

    // --- æ–°å¢ï¼šæŠ•æ·æ¼‚æµç“¶é€»è¾‘ ---
    function throwBottle() {
        const input = document.getElementById('bottle-message');
        const feedback = document.getElementById('bottle-feedback');
        const msg = input.value.trim();
        
        if (!msg) {
            input.placeholder = "å†™ç‚¹ä»€ä¹ˆå§ï¼Œå“ªæ€•åªæ˜¯ä¸€ä¸ªå¥å·...";
            input.focus();
            return;
        }

        // 1. æ’­æ”¾éŸ³æ•ˆ
        if(AudioEngine && AudioEngine.playSplash) AudioEngine.playSplash();

        // 2. åˆ›å»ºä¸€ä¸ªè§†è§‰ä¸Šçš„ç“¶å­å…ƒç´ 
        const bottle = document.createElement('div');
        bottle.innerText = "ğŸ§´"; // ä¹Ÿå¯ä»¥ç”¨ ğŸ“œ æˆ– âœ‰ï¸
        bottle.style.cssText = `
            position: fixed;
            left: 50%;
            bottom: 30%;
            font-size: 40px;
            z-index: 50;
            transform: translateX(-50%);
            transition: all 1s cubic-bezier(0.5, 0, 1, 1);
            pointer-events: none;
        `;
        document.body.appendChild(bottle);

        // 3. æ‰§è¡Œæ‰è½åŠ¨ç”»
        requestAnimationFrame(() => {
            bottle.style.bottom = "-10%"; // æ‰å‡ºå±å¹•åº•éƒ¨
            bottle.style.transform = "translateX(-50%) rotate(45deg) scale(0.5)"; // å˜å°å¹¶æ—‹è½¬
            bottle.style.opacity = "0";
        });

        // 4. UI çŠ¶æ€æ›´æ–°
        input.value = "";
        input.disabled = true;
        input.placeholder = "......";
        feedback.classList.remove('hidden');

        // 5. åˆ¶é€ ä¸€ç‚¹æ³¢æµªæ¶Ÿæ¼ª (ä¸æ»‘åŠ é€Ÿå’Œæ¢å¤)
        const waves = document.querySelectorAll('.wave-layer');
        
        // æ”¹å˜æ’­æ”¾é€Ÿç‡ï¼ˆæ·»åŠ å‰ç¼€æ”¯æŒï¼‰
        waves.forEach((w) => {
            // è®¾ç½®å¤šä¸ªå±æ€§åä»¥ç¡®ä¿æµè§ˆå™¨å…¼å®¹æ€§
            w.style.setProperty('animation-play-rate', '3', '');
            w.style.setProperty('-webkit-animation-play-rate', '3', '');
        });
        
        setTimeout(() => {
            // å¹³æ»‘æ¢å¤åˆ°æ­£å¸¸é€Ÿåº¦
            waves.forEach((w) => {
                w.style.setProperty('animation-play-rate', '1', '');
                w.style.setProperty('-webkit-animation-play-rate', '1', '');
            });
            bottle.remove(); // æ¸…ç†å…ƒç´ 
            input.disabled = false; // æ¢å¤è¾“å…¥æ¡†
        }, 1500);
        
        // 6. (å¯é€‰) ä¿å­˜åˆ°æœ¬åœ°ï¼Œä½œä¸ºå½©è›‹
        localStorage.setItem('originsight_bottle', msg);
    }

    // æ”¾åœ¨ <script> çš„æœ«å°¾
    function changeVolume(val) {
        const audio = document.getElementById('bg-music');
        if (audio) {
            audio.volume = val;
        }
        // æ‹–åŠ¨æ»‘å—æ—¶ï¼Œå¦‚æœæœ¬æ¥æ˜¯é™éŸ³ï¼Œå°±è‡ªåŠ¨å¼€å¯å£°éŸ³
        if (AudioEngine.isMuted && val > 0) {
            AudioEngine.toggleMute();
        }
    }

    // --- æ–°å¢ï¼šæ‰“å­—æœºç‰¹æ•ˆ (è®©æ–‡å­—é€ä¸ªæµ®ç°) ---
    function typeWriter(elementId, text, speed = 50) {
        const el = document.getElementById(elementId);
        if (!el) return;
        el.innerHTML = ""; // æ¸…ç©ºåŸæœ‰æ–‡æœ¬
        el.style.opacity = 1;
        
        let i = 0;
        function type() {
            if (i < text.length) {
                el.innerHTML += text.charAt(i);
                i++;
                setTimeout(type, speed);
            }
        }
        type();
    }

    // --- æ›´æ–°ï¼šä¸ƒæ—¥è®¡åˆ’æ‰“å¡ (å¸¦è®°å¿†åŠŸèƒ½) ---
    function toggleDailyTask(el, index) {
        // è¯»å–å½“å‰è¿›åº¦
        let savedChecks = JSON.parse(localStorage.getItem('originsight_plan_checks') || '[]');
        const dot = el.querySelector('div > div');
        const text = el.querySelector('span');
        
        // åˆ‡æ¢çŠ¶æ€
        if (dot.classList.contains('opacity-0')) {
            // é€‰ä¸­
            dot.classList.remove('opacity-0');
            el.classList.add('bg-teal-50', 'border-teal-200');
            el.classList.remove('bg-white/60', 'border-teal-100');
            text.classList.add('line-through', 'text-teal-400');
            text.classList.remove('text-gray-700');
            // ä¿å­˜
            if (!savedChecks.includes(index)) savedChecks.push(index);
        } else {
            // å–æ¶ˆ
            dot.classList.add('opacity-0');
            el.classList.remove('bg-teal-50', 'border-teal-200');
            el.classList.add('bg-white/60', 'border-teal-100');
            text.classList.remove('line-through', 'text-teal-400');
            text.classList.add('text-gray-700');
            // ç§»é™¤
            savedChecks = savedChecks.filter(i => i !== index);
        }
        
        // ä¿å­˜å›æœ¬åœ°
        localStorage.setItem('originsight_plan_checks', JSON.stringify(savedChecks));
        
        // æ›´æ–°è¿›åº¦æ¡æ–‡å­— (å¯é€‰)
        const progressText = document.getElementById('plan-progress-text');
        if (progressText) {
            progressText.innerText = `å·²å®Œæˆ ${savedChecks.length} / 7`;
        }
    }
</script>

<div id="image-modal" class="fixed inset-0 z-[100] bg-black/90 hidden flex flex-col items-center justify-center p-4 backdrop-blur-sm transition-opacity duration-300">
    <div class="relative w-full max-w-sm bg-transparent flex flex-col items-center">
        <button onclick="closeImageModal()" class="absolute -top-12 right-0 text-white/80 hover:text-white text-sm bg-white/10 px-4 py-2 rounded-full backdrop-blur-md transition">
            âœ• å…³é—­
        </button>
        
        <div id="generated-image-container" class="w-full rounded-2xl overflow-hidden shadow-2xl border border-white/20">
            </div>

        <p class="text-white/60 text-sm mt-6 animate-pulse">
            ğŸ‘† é•¿æŒ‰ä¸Šæ–¹å›¾ç‰‡å³å¯ä¿å­˜ / åˆ†äº«
        </p>
    </div>
</div>
</body>
</html>
